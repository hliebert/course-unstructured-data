Journal of Econometrics 113 (2003) 231 ­ 263 www.elsevier.com/locate/econbase
Semiparametric instrumental variable estimation of treatment response models
Alberto Abadie
John F. Kennedy School of Government, Harvard University, Cambridge, MA 02138, USA
Abstract This article introduces a new class of instrumental variable (IV) estimators for linear and
nonlinear treatment response models with covariates. The rationale for focusing on nonlinear models is that, if the dependent variable is binary or limited, or if the e ect of the treatment varies with covariates, a nonlinear model is appropriate. In the spirit of Roehrig (Econometrica 56 (1988) 433), identiÿcation is attained nonparametrically and does not depend on the choice of the parametric speciÿcation for the response function of interest. One virtue of this approach is that it allows the researcher to construct estimators that can be interpreted as the parameters of a well-deÿned approximation to a treatment response function under functional form misspeciÿcation. In contrast to some usual IV models, heterogeneity of treatment e ects is not restricted by the identiÿcation conditions. The ideas and estimators in this article are illustrated using IV to estimate the e ects of 401(k) retirement programs on savings. c 2002 Elsevier Science B.V. All rights reserved.
JEL classiÿcation: C13; C14; H31
Keywords: Treatment e ects; Semiparametric estimation; Compliers; 401(k)
1. Introduction
Economists have long been concerned with the problem of how to estimate the e ect of a treatment on some outcome of interest, possibly after conditioning on a vector of covariates. The main empirical challenge in studies of this type arises from the fact that selection for treatment is usually related to the potential outcomes that individuals would attain with and without the treatment. Therefore, systematic di erences in the distribution of the outcome variable between treated and non-treated may re ect not only the e ect of the treatment, but also di erences generated by the selection process.
 Tel.: +1-617-496-4547; fax: +1-617-496-5960. E-mail address: alberto abadie@harvard.edu (A. Abadie).
0304-4076/03/$ - see front matter c 2002 Elsevier Science B.V. All rights reserved. PII: S 0 3 0 4 - 4 0 7 6 ( 0 2 ) 0 0 2 0 1 - 4

232

A. Abadie / Journal of Econometrics 113 (2003) 231 ­ 263

A variety of methods have been proposed to overcome the selection problem (for a review see Heckman and Robb, 1985). The traditional approach relies on distributional assumptions and functional form restrictions to identify average treatment e ects and other treatment parameters of interest. Unfortunately, estimators based on this approach can be seriously biased by modest departures from the parametric assumptions (Goldberger, 1983). In addition, a number of researchers have noted that strong parametric assumptions are not necessary to identify treatment parameters of interest (see e.g., Heckman, 1990; Imbens and Angrist, 1994; Manski, 1997). Consequently, it is desirable to develop robust estimators of treatment parameters based on nonparametric or semiparametric identiÿcation procedures.
Motivated by these considerations, this article introduces a new class of instrumental variable (IV) estimators of linear and nonlinear average treatment response models with covariates. In the spirit of Roehrig (1988), identiÿcation is attained nonparametrically and does not depend on the choice of the parametric speciÿcation for the response function of interest. The main advantage of this approach is that it allows the researcher to construct estimators that can be interpreted as the parameters of a well-deÿned approximation to a treatment response function under functional form misspeciÿcation. On the other hand, if required, functional form restrictions and distributional assumptions can be accommodated in the analysis. As in the IV model of Imbens and Angrist (1994) and Angrist et al. (1996), identiÿcation comes from a binary instrument that induces exogenous selection into treatment for some subset of the population. In contrast with Imbens and Angrist (1994) and Angrist et al. (1996), the approach taken here easily accommodates covariates and can be used to estimate nonlinear models with a binary endogenous regressor.
The ability to control for covariates is important because instruments may require conditioning on a set of covariates to be valid. Covariates can also be used to re ect observable di erences in the composition of populations, making extrapolation more credible. Another feature of the approach taken here, the ability to estimate nonlinear models, is important because in some cases, such as evaluation problems with limited dependent variables, the underlying response function of interest is inherently nonlinear. As a by-product of the general framework introduced here, I develop an IV estimator that provides a linear least squares approximation to an average treatment response function, just as Ordinary Least Squares (OLS) provides a linear least squares approximation to a conditional expectation. It is shown that Two Stage Least Squares (2SLS) typically does not have this property. The interpretation of alternative IV estimators as average treatment response estimators is brie y studied. In contrast to some usual IV models, the identiÿcation conditions adopted in this article do not restrict treatment e ects to be constant or to be a deterministic function of the covariates.
Previous e orts to introduce covariates in the IV model of Imbens and Angrist (1994) include Little and Yau (1998), Hirano et al., (2000) and Angrist and Imbens (1995). Little and Yau (1998) and Hirano et al. (2000) use distributional assumptions and functional form restrictions to accommodate covariates. The approach in Angrist and Imbens (1995) is only valid for fully saturated speciÿcations involving discrete covariates. In contrast, the identiÿcation procedure introduced here requires no

A. Abadie / Journal of Econometrics 113 (2003) 231 ­ 263

233

parametric assumptions for identiÿcation, while allowing the estimation of a parsimonious parameterization for the response function of interest.
The rest of the article is organized as follows. Section 2 reviews an IV approach to identiÿcation of treatment parameters, introducing the concepts and notation used throughout the article. Section 3 presents the main identiÿcation theorem. Section 4 uses the results from the previous section to develop estimators of treatment response functions. Asymptotic distribution theory is also provided. Section 5 studies the interpretation of alternative IV estimators as treatment parameters under the identifying conditions used in this article. Section 6 uses the approach introduced in this article to estimate the e ects of 401(k) programs on savings, a question originally explored in a series of articles by Engen et al. (1994, 1996) and Poterba et al. (1994, 1995, 1996) among others. Section 7 summarizes and suggests directions for future research. Proofs are provided in Appendix A.

2. The framework

2.1. The identiÿcation problem

Suppose that we are interested in the e ect of some treatment, say college graduation,
which is represented by the binary variable D, on some outcome of interest Y , such as
earnings. As in Rubin (1974, 1977), we deÿne Y1 and Y0 as the potential outcomes that an individual would attain with and without being exposed to the treatment. Treatment
parameters are deÿned as characteristics of the distribution of (Y1; Y0) for well-deÿned subpopulations.
In the example, Y1 represents potential earnings as a college graduate while Y0 represents potential earnings as a non-graduate. The treatment e ect of college graduation
on earnings is then naturally deÿned as Y1 - Y0. Now, an identiÿcation problem arises from the fact that we cannot observe both potential outcomes Y1 and Y0 for the same individual, we only observe Y = Y1D + Y0(1 - D). Since one of the potential outcomes is always missing we cannot compute the treatment e ect, Y1 - Y0, for any individual. We may still want to estimate the average treatment e ect E[Y1 - Y0], or the average e ect of the treatment on the treated E[Y1 - Y0|D = 1]. However, comparisons of average earnings for treated and non-treated do not usually give the right answer:

E[Y |D = 1] - E[Y |D = 0] = E[Y1|D = 1] - E[Y0|D = 0]

= E[Y1 - Y0|D = 1] + {E[Y0|D = 1]

- E[Y0|D = 0]}:

(1)

The ÿrst term of the right-hand side of Eq. (1) gives the average e ect of the treatment on the treated. The second term represents the bias caused by endogenous selection into treatment. In general, this bias is di erent from zero because anticipated potential outcomes may a ect selection into treatment.
Of course, treatment e ects are not the only treatment parameters of interest. In particular, optimal treatment choice may require forecasting average responses under

234

A. Abadie / Journal of Econometrics 113 (2003) 231 ­ 263

the treatment/no treatment regimes, Y1 and Y0, for di erent groups of the population (as in Manski, 2000). In such cases, averages of Y1 and Y0 are to be estimated separately.

2.2. Identiÿcation by instrumental variables
IV methods have been proposed to recover treatment parameters in Heckman and Robb (1985), Imbens and Angrist (1994), Heckman and Vytlacil (1999), and Manski and Pepper (2000) among others. This article follows the approach of Imbens and Angrist (1994).
Suppose that there is a binary instrument Z available to the researcher. The formal requisites for an instrument to be valid are stated below. Informally speaking, the role of an instrument is to induce exogenous variation in the treatment variable. The formulation of the IV model of Imbens and Angrist (1994) recognizes the dependence between the treatment and the instrument by using potential treatment indicators. The binary variable Dz represents potential treatment status given Z = z. Suppose, for example, that Z is an indicator of college proximity (see Card, 1993). Then D0=0 and D1=1 for a particular individual means that such individual would graduate from college if living nearby a college at the end of high school, but would not graduate otherwise. The treatment status indicator variable can then be expressed as D = ZD1 + (1 - Z)D0. In practice, we observe Z and D (and therefore Dz for individuals with Z = z), but we do not observe both potential treatment indicators. Following the terminology of Angrist et al. (1996), the population is divided in groups deÿned by the potential treatment indicators D1 and D0. Compliers are those individuals who have D1 ¿ D0 (or equivalently, D0 = 0 and D1 = 1). In the same fashion, always-takers are deÿned by D1 = D0 = 1 and never-takers by D1 = D0 = 0. Finally, deÿers are deÿned by D1 ¡ D0 (or D0 = 1 and D1 = 0). Notice that, since only one of the potential treatment indicators (D0; D1) is observed, we cannot identify which one of these four groups any particular individual belongs to.
In order to state the properties that a valid instrument should have, we need to include Z in the deÿnition of potential outcomes. For a particular individual, the variable Yzd represents the potential outcome that this individual would obtain if Z = z and D = d. In the schooling example, Y01 represents the potential earnings that some individual would obtain if not living near a college at the end of high school but being college graduate. Clearly, if D0 = 0 for some individual, we will not be able to observe Y01 for such individual.
The following identifying assumption is used in most of the article. It contains a set of nonparametric conditions under which IV techniques can be used to identify meaningful treatment parameters. X represents a vector of predetermined variables.
Assumption 2.1.
(i) Independence of the instrument: Conditional on X , the random vector (Y00; Y01; Y10; Y11; D0; D1) is independent of Z.
(ii) Exclusion of the instrument: P(Y1d = Y0d|X ) = 1 for d  {0; 1}.

A. Abadie / Journal of Econometrics 113 (2003) 231 ­ 263

235

(iii) First stage: 0 ¡ P(Z = 1|X ) ¡ 1 and P(D1 = 1|X ) ¿ P(D0 = 1|X ). (iv) Monotonicity: P(D1 ¿ D0|X ) = 1.

These assumptions are essentially the conditional versions of those used in Angrist et al. (1996). Vytlacil (2002) has shown the equivalence between these assumptions and those imposed by a nonparametric selection model. Assumption 2.1(i) is sometimes called ignorability and it means that Z is "as good as randomly assigned" once we condition on X . Assumption 2.1(ii) means that variation in the instrument does not change potential outcomes other than through D. This assumption allows us to deÿne potential outcomes in terms of D alone so we have Y0 = Y00 = Y10 and Y1 = Y01 = Y11. Together, Assumptions 2.1(i) and (ii) guarantee that the only e ect of the instrument on the outcome is through variation in treatment status. Assumption 2.1(iii) is related to the ÿrst stage, it guarantees that Z and D are correlated conditional on X . In addition, Assumption 2.1(iii) implies that the support of X conditional on Z = 1 coincides with the support of X conditional on Z = 0. Assumption 2.1(iv) rules out the existence of deÿers and deÿnes a partition of the population into always-takers, compliers, and never-takers. Monotonicity is usually easy to assess from the institutional knowledge of the problem. For the schooling example monotonicity means that those who would graduate from college if not living nearby a college would also graduate from college if living nearby one, holding everything else equal. In this setting, a possible instrument, Z, is said to be valid if Assumption 2.1 holds. In what follows, it is enough that Assumption 2.1 holds almost surely with respect to the probability law of X .
Imbens and Angrist (1994) show that if Assumption 2.1 holds in absence of covariates, then a simple IV estimand identiÿes the average treatment e ect for compliers (which they call Local Average Treatment E ect or LATE):

IV

=

cov(Y; Z) cov(D; Z)

=

E[Y |Z E[D|Z

= =

1] 1]

- -

E[Y |Z E[D|Z

= =

0] 0]

=

E[Y1

-

Y0|D1

¿

D0]:

(2)

Moreover, it has been shown that, under the same assumptions, the entire marginal distributions of potential outcomes are identiÿed for compliers (see Imbens and Rubin, 1997; Abadie, 2002). In particular, Abadie (2002) shows that if Assumption 2.1 holds in absence of covariates:

E[Y1|D1

¿

D0]

=

E[YD|Z E[D|Z

= =

1] 1]

- -

E[YD|Z = 0] E[D|Z = 0]

;

(3)

E[Y0|D1

¿

D0]

=

E[Y (1 E[(1

- -

D)|Z D)|Z

= =

1] 1]

- -

E[Y (1 - D)|Z = 0] E[(1 - D)|Z = 0]

:

(4)

Eqs. (3) and (4) identify average treatment responses for compliers. Although the results in Eqs. (2)­(4) do not incorporate covariates, they can easily be extended in that direction. Note that under Assumption 2.1, Eqs. (2)­(4) must hold conditional on X . If X is discrete with ÿnite support, it is straightforward to produce estimators of E[Y1|X; D1 ¿ D0] and E[Y0|X; D1 ¿ D0]. If X is continuous, the estimation process can be based on nonparametric smoothing techniques. The main advantage of this strategy resides in the exibility of functional form. However, nonparametric methods

236

A. Abadie / Journal of Econometrics 113 (2003) 231 ­ 263

have disadvantages related to the interpretation of the results and the precision of the estimators. 1 Furthermore, nonparametric methods are not suitable for extrapolation
outside the observed support of the covariates. On the other hand, parameterization of
the four expectations in the conditional versions of Eqs. (3) and (4) will in general produce undesirable speciÿcations for the treatment response function. 2 The method
proposed in this article allows us to estimate parsimonious parameterizations for the
average response functions for compliers.

3. Identiÿcation of statistical characteristics for compliers

This section presents an identiÿcation theorem that includes previous results on IV models for treatment e ects as special cases, and provides the basis for new identiÿcation results. To study identiÿcation we proceed as if we knew the joint distribution of (Y; D; X; Z). In practice, we can use a random sample from (Y; D; X; Z) to construct estimators based on sample analogs of the population results.

Lemma 2.1. Under Assumption 2.1, P(D1 ¿ D0|X ) = E[D|Z = 1; X ] - E[D|Z = 0; X ] ¿ 0:

This lemma says that, under Assumption 2.1, the proportion of compliers in the population is identiÿed given X and this proportion is greater than zero. This preliminary result is important for establishing the following theorem.

Theorem 3.1. Let g(·) be any measurable real function of (Y; D; X ) such that E|g(Y; D; X )| ¡ . Deÿne

Ä(0)

=

(1

-

D)

(1 - Z) - P(Z P(Z = 0|X )P(Z

= 0|X ) = 1|X )

;

Ä(1)

=

D

Z - P(Z = 1|X ) P(Z = 0|X )P(Z = 1|X

)

;

Ä

=

Ä(0)P(Z

=

0|X )

+

Ä(1)P(Z

=

1|X

)

=

1

-

D(1 - Z) P(Z = 0|X )

-

(1 - D)Z P(Z = 1|X

)

:

Under Assumption 2.1,

(a)

E[g(Y; D; X )|D1 ¿ D0]

=

P(D1

1 ¿

D0)

E[Ä

g(Y; D; X )].

Also,

1 For fully nonparametric estimators, the number of observations required to attain an acceptable preci-
sion increases very rapidly with the number of covariates. This problem is sometimes called the curse of
dimensionality and makes precision of nonparametric estimators be typically low. 2 For example, linear speciÿcations for the conditional versions of the four averages in Eq. (3) do not
produce a linear speciÿcation for E[Y1|X; D1 ¿ D0]. Moreover, if Y is binary and the four expectations are parameterized as Probits, the range for the resulting speciÿcation for E[Y1|X; D1 ¿ D0] is not restricted to lie in between 0 and 1.

A. Abadie / Journal of Econometrics 113 (2003) 231 ­ 263

237

(b)

E[g(Y0; X )|D1

¿ D0] =

P(D1

1 ¿

D0

)

E[Ä(0)

g(Y;

X

)],

and

(c)

E[g(Y1; X )|D1

¿ D0]

=

P(D1

1 ¿

D0)

E[Ä(1)g(Y;

X

)].

Moreover, (a­c) also hold conditional on X .

Note that setting g(Y; D; X ) = 1 we obtain E[Ä] = P(D1 ¿ D0), so we can think about Ä as a weighting scheme that allows us to identify expectations for compliers. However, Ä does not produce proper weights since when D di ers from Z, Ä takes negative values.
Theorem 3.1 is a powerful identiÿcation result; it says that any statistical characteristic that can be deÿned in terms of moments of the joint distribution of (Y; D; X ) is identiÿed for compliers. Since D is exogenous given X for compliers, Theorem 3.1 can be used to identify meaningful treatment parameters for this group of the population. The next section applies Theorem 3.1 to the estimation of average treatment response functions for compliers.

4. Estimation of average response functions
4.1. Local average response functions
Consider the function of (D; X ) that is equal to E[Y0|X; D1 ¿ D0] if D = 0, and is equal to E[Y1|X; D1 ¿ D0] if D =1. This function describes average treatment responses for any group of compliers deÿned by some value for the covariates. Borrowing from the terminology in Imbens and Angrist (1994), I will refer to this function as the Local Average Response Function (LARF).
Since Z = D for compliers, under Assumptions 2.1(i) and (ii) Z is ignorable for compliers given X . It follows that:
E[Y |X; D = 0; D1 ¿ D0] = E[Y0|X; Z = 0; D1 ¿ D0] = E[Y0|X; D1 ¿ D0]
and
E[Y |X; D = 1; D1 ¿ D0] = E[Y1|X; Z = 1; D1 ¿ D0] = E[Y1|X; D1 ¿ D0]:
Also,
E[Y |X; D = 1; D1 ¿ D0] - E[Y |X; D = 0; D1 ¿ D0] = E[Y1 - Y0|X; D1 ¿ D0];
therefore, E[Y |X; D; D1 ¿ D0] is the LARF. An important special case arises when P(D0 = 0|X ) = 1. This happens, for example,
in randomized experiments when there is perfect exclusion of the control group from the treatment. In such cases,
E[Y |X; D = 0; D1 ¿ D0] = E[Y0|X; Z = 0; D1 = 1]
= E[Y0|X; Z = 1; D1 = 1] = E[Y0|X; D = 1]

238

A. Abadie / Journal of Econometrics 113 (2003) 231 ­ 263

and similarly E[Y |X; D = 1; D1 ¿ D0] = E[Y1|X; D = 1], so the LARF describes the e ect of the treatment for the treated given X . Note also that when P(D0 = 0|X ) = 1 or, more generally, when P(D0 = 0  D1 = 1|X ) = 1, then monotonicity holds trivially.
The fact that the conditional expectation of Y given D and X for compliers has
an interpretation as an average treatment response function would not be very useful
in the absence of Theorem 3.1. Since only one potential treatment status is observed,
compliers are not individually identiÿed. Therefore, the LARF cannot be estimated
directly because we cannot construct a sample of compliers. Theorem 3.1 provides a
solution to this identiÿcation problem by expressing expectations for compliers in terms of expectations for the whole population. 3

4.2. Estimation

This section describes two ways to learn about the LARF: (i) estimate a parameterization of the LARF by Least Squares (LS), (ii) specify a parametric distribution for P(Y |X; D; D1 ¿ D0) and estimate the parameters of the LARF by Maximum Likelihood (ML). Identiÿcation of the conditional distribution of Y given D and X for compliers does not depend, however, on the particular parametric speciÿcation adopted for LS or ML. As a result, the estimators proposed here have appealing interpretations under misspeciÿcation of the parameterization in (i) or (ii).
Throughout, W = (Y; D; X; Z) and {wi}ni=1 is a sample of realizations of W .

4.2.1. Least squares
Suppose that the LARF belongs to some class of parametric functions H = {h(D; X ; Â): Â   Rm} in the Lebesgue space of square-integrable functions. 4 Let
Â0 be the vector of parameters such that E[Y |X; D; D1 ¿ D0] = h(D; X ; Â0). Then

Â0 = arg min E[{Y - h(D; X ; Â)}2|D1 ¿ D0]:
Â

Since we do not observe both D0 and D1 the equation above cannot be directly applied to the estimation of Â0. However, by Theorem 3.1 we have

Â0 = arg min E[Ä(Y - h(D; X ; Â))2]:

(5)

Â

Under functional form misspeciÿcation (i.e., if the LARF does not belong to H), Â0 are the parameters of the best least squares approximation from H to E[Y |D; X; D1 ¿ D0] (White, 1981):

Â0 = arg min E[{E[Y |D; X; D1 ¿ D0] - h(D; X ; Â)}2|D1 ¿ D0]:
Â

For expositional purposes, suppose that we know the function 0(x)=P(Z =1|X =x). Then, we can construct {Äi}ni=1 and apply Eq. (5) to estimate Â0. The study of the

3 The average response is not necessarily the only treatment response function of interest. Abadie et al.
(2002) apply Theorem 3.1 to the estimation of quantile response functions for compliers. 4 To avoid existence problems, H can be restricted such that Â  h(·; ·; Â) is a continuous mapping on
compact.

A. Abadie / Journal of Econometrics 113 (2003) 231 ­ 263

239

more empirically relevant case in which the function 0(·) has to be estimated in a

ÿrst step is postponed until Section 4.3. Following the Analogy Principle (see Manski,

1988), a natural estimator of Â0 is given by the sample counterpart of Eq. (5):

Â^ = arg min
Â

1 n

n i=1

Äi (yi

- h(di; xi; Â))2;

where Äi = 1 - di(1 - zi)=(1 - 0(xi)) - (1 - di)zi= 0(xi). For example, suppose that we want to estimate a linear parameterization for the
LARF. In this case h(D; X ; Â) = D + X ÿ and Â = ( ; ÿ). The parameters of the LARF can be expressed as

( 0; ÿ0) = arg min E[{Y - ( D + X ÿ)}2|D1 ¿ D0]:

(6)

( ;ÿ)

Theorem 3.1 and the Analogy Principle lead to the the following estimator:

( ^; ÿ^) = arg min
( ;ÿ)

1 n

n i=1

Äi (yi

-

di - xi ÿ)2:

(7)

Linear speciÿcations are very popular because they summarize the e ect of each covariate on the outcome in a single parameter. However, in many situations we are actually interested in how the e ect of the treatment varies with the covariates. Also, when the dependent variable is limited, nonlinear response functions may provide a more accurate description of the LARF.
Probit transformations of linear functions are often used when the dependent variable is binary. In such cases, the objects of interest are conditional probabilities and the Probit function restricts the approximation to lie in between zero and one. Another appealing feature of the Probit speciÿcation is that the estimated e ect of the treatment is allowed to change with covariates. As usual, let (·) be the cumulative distribution function of a standard normal. The parameters of a Probit speciÿcation for the LARF are given by

( 0; ÿ0) = arg min E[{Y - ( D + X ÿ)}2|D1 ¿ D0]:
( ;ÿ)

Again, Theorem 3.1 along with the Analogy Principle, suggest the following estimator

for Â0 = ( 0; ÿ0):

( ^; ÿ^) = arg min
( ;ÿ)

1 n

n i=1

Äi (yi

-

( di + xi ÿ))2:

(8)

4.2.2. Maximum likelihood In some cases, the researcher may be willing to specify a parametric distribu-
tion for P(Y |X; D; D1 ¿ D0) (with density f(Y; D; X ; Â0) for Â0  and expectation E[Y |D; X; D1 ¿ D0] = h(D; X ; Â0)), and estimate Â0 by ML. Under this kind of distributional assumption we have

Â0 = argmax E[ln f(Y; D; X ; Â)|D1 ¿ D0]:

(9)

Â

240

A. Abadie / Journal of Econometrics 113 (2003) 231 ­ 263

As before, in order to express the problem in Eq. (9) in terms of moments for the whole population we apply Theorem 3.1 to get

Â0 = argmax E[Ä ln f(Y; D; X ; Â)]:
Â

Under misspeciÿcation of P(Y |X; D; D1 ¿ D0), Â0 can be interpreted as the parameters which minimize the Kullback­Leibler Information Criterion for compliers (see White,

1982).

An analog estimator for the last equation exploits the ML principle after weighting

with Äi:

Â^ = argmax
Â

1 n

n i=1

Äi ln f(yi; di; xi; Â):

Following with the Probit example of Section 4.2.1, suppose that we consider
E[Y |D; X; D1 ¿ D0] = ( 0D + X ÿ0). Since Y is binary, E[Y |D; X; D1 ¿ D0] provides a complete speciÿcation of the conditional distribution P(Y |D; X; D1 ¿ D0). Under this assumption, for containing ( 0; ÿ0), we have

( 0; ÿ0) = argmax E[Y ln ( D + X ÿ) + (1 - Y ) ln (- D - X ÿ)|D1 ¿ D0]
( ;ÿ)

= argmax E[Ä{Y ln ( D + X ÿ) + (1 - Y ) ln (- D - X ÿ)}]:
( ;ÿ)

Therefore, an analog estimator of ( 0; ÿ0) is given by

( ^; ÿ^) = argmax
( ;ÿ)

1 n

n i=1

Äi(yi ln

( di + xi ÿ)

+ (1 - yi) ln (- di - xi ÿ)):

(10)

In addition to the approaches adopted for LS and ML, there is a broad range of models that impose di erent restrictions on P(Y |D; X; D1 ¿ D0). Median independence and symmetry are examples of possible restrictions that allow identiÿcation of interesting features of P(Y |D; X; D1 ¿ D0). For the sake of brevity, these kinds of models are not explicitly considered in this article. However, the basic framework of identiÿcation and estimation presented here also applies to them. Note also that although this section (and the rest of the article) only exploits part (a) of Theorem 3.1, parts (b) and (c) of Theorem 3.1 can also be used in a similar way to identify and estimate treatment parameters.

4.3. Distribution theory
For any measurable real function q(·; ), let q( ) = q(W ; ) and qi( ) = q(wi; ) where represents a (possibly inÿnite-dimensional) parameter. Also, · denotes the Euclidean norm. The next assumption is the usual identiÿcation condition invoked for extremum estimators.

A. Abadie / Journal of Econometrics 113 (2003) 231 ­ 263

241

Assumption 4.1. The expectation E[g(Â)|D1 ¿ D0] has a unique minimum at Â0 over Â .

The speciÿc form of g(Â) depends on the model and the identiÿcation strategy, and it will be left unrestricted except for regularity conditions. For LS, the function g(Â) is a quadratic loss, for ML it is minus the logarithm of a density for W .
If we know the nuisance function 0, then Ä is observable and the estimation of Â0 is carried out in a single step:

Â^ = arg min
Â

1 n

n i=1

Äi (

0 )gi (Â):

(11)

The asymptotic distribution for such an estimator can be easily derived from the

standard asymptotic theory for extremum estimators (see e.g., Newey and McFadden,

1994).

If 0 is unknown, which is often the case, we can estimate 0 in a ÿrst step and then plug the estimates of 0(xi) in Eq. (11) to solve for Â^ in a second step. If 0

has a known parametric form (or if the researcher is willing to assume one), 0 can

be estimated using conventional parametric methods. If the form of 0 is unrestricted (except for regularity conditions), we can construct a semiparametric two-step estimator that uses a nonparametric ÿrst step estimator of 0. Asymptotic theory for Â^ in each case

is provided below. Section 4.3.1 focuses on the parametric case, when 0 = (X; 0) for some known function and 0  R l. Section 4.3.2 derives the asymptotic distribution for Â^ when 0 is estimated nonparametrically in a ÿrst step using power series. As

tehxaptlauinndeedrsbmeoloowth,inogneisandovtannetacgeessoarfyÿtrostacshteiepvseeriens-ceosntismisatetinocny

over kernel methods is for Â^. This is important

because the estimate of 0 can sometimes be an interesting by-product of the estimation

process.

The asymptotic distributions are derived under general misspeciÿcation. As a conse-

quence, the resulting standard errors are robust to misspeciÿcation.

4.3.1. Parametric ÿrst step This section studies two-step estimation procedures for Â0 that are based on Eq. (11)
and that use a parametric estimator in the ÿrst step. 5 First, we establish the consistency of such estimators.

Theorem 4.1. Suppose that Assumptions 2.1 and 4.1 hold and that (i) the data are i.i.d.; (ii) is compact; (iii) 0(·) belongs to some (known) parametric class of functions (·; ) such that for some 0  Rl, 0(X ) = (X; 0); there exists Á ¿ 0 such that for - 0 ¡ Á, (X; ) is bounded away from zero and one and is continuous at each on the support of X ; (iv) ^p 0; (v) g(Â) is continuous at each Â 
5 Note that in some cases we may know a parametric form for 0. The main example is when X is discrete with ÿnite support. Then, 0 is linear in a saturated model that includes indicators for all possible values of X . For other cases, nonlinear models such as Probit or Logit can be used in the ÿrst step to guarantee that the estimate of 0 lies in between zero and one.

242

A. Abadie / Journal of Econometrics 113 (2003) 231 ­ 263

with probability one; there exists b(W ) such that g(Â) 6 b(W ) for all Â  and E[b(W )] ¡ . Then Â^p Â0.

We say that an estimator '^ of some parameter '0 is asymptotically linear with in uence function (W ) when

 n('^

-

'0)

=

1 n

n

(wi) + op(1) and E[ (W )] = 0; E[ (W ) 2] ¡ :

i=1

The next theorem provides su cient conditions for asymptotic normality of Â^ when the ÿrst step estimator of 0 is asymptotically linear. This requirement is very weak because most estimators used in econometrics fall in this class.

Theorem 4.2. If the assumptions of Theorem 4.1 hold and (i) Â0  interior( ); (ii)

there exist Á ¿ 0 and b(W ) such that for Â - Â0 ¡ Á, g(Â) is twice continuously

di erentiable and E[supÂ: Â-Â0 ¡Á @2g(Â)=@Â@Â ] ¡ , and for - 0 ¡ Á, (X; ) is continuously di erentiable at each , @ (X; )=@ 6 b(W ) and E[b(W )2] ¡ ; (iii)

^ is and

MasÂym=pEto[Äti(c@a2lgly(Âl0i)n=e@aÂr@Âw)it]hisinnoune-nsicnegufulanrc.tiTohnen,(Wn)(;Â^(-iv)Â0E)[d @Ng((0Â;0V)=)@Âwh2e]r¡e 

V = MÂ-1E

Ä

@g(Â0 @Â

)

+

M

Ä

@g(Â0) @Â

+

M

MÂ-1;

and M = E[(@g(Â0)=@Â)(@Ä( 0)=@ )].

In order to make inference operational, we need a consistent estimator of the asymptotic variance matrix V . Consider

V^

=

M^

-1 Â

1n n
i=1

Äi (

^)

@gi(Â^) @Â

+

M^

^i

Äi

(

^)

@gi(Â^) @Â

+

M^

^i

M^ -Â 1;

where M^ Â and M^ are the sample analogs of MÂ and M evaluated at the estimates. Typically, ^ is also some sample counterpart of where 0 has been substituted
by ^.

Theorem 4.3. If the conditions of Theorem 4.2 hold and (i) there is b(W ) such that

for close enough to 0, Ä( )@g(Â)=@Â-Ä( 0)@g(Â0)=@Â 6 b(W )( - 0 + Â-Â0 )

and E[b(W )2] ¡ ; (ii) n-1

n i=1

^i - i 2p 0, then V^ p V .

4.3.2. Semiparametric estimation using power series First step parametric estimation procedures are easy to implement. However, consis-
tency of Â^ depends on the correct speciÿcation of the ÿrst step. Therefore, nonparametric procedures in the ÿrst step are often advisable when we have little knowledge about the functional form of 0.
This section considers two-step estimators of Â0 that use power series in a ÿrst step to estimate 0. The main advantage of this type of semiparametric estimators over those

A. Abadie / Journal of Econometrics 113 (2003) 231 ­ 263

243

wtohaictthaiunse kne-crnoenlsimsteetnhcoydsofisÂ^t(hsaeteuen.dge.,rsNmeowoethyinangdinMtchFeaÿdrdsetns,te1p99m4a)y. Ontohtebreadnveacnetsasgaerys

of series estimation are that it easily accommodates dimension-reducing nonparametric

restrictions to 0 (e.g., additive separability) and that it requires low computational

e ort. The motivation for focusing on a particular type of approximating functions

(power series) is to provide primitive regularity conditions. For brevity, other types of

approximating series such as splines are not considered here, but the results can be

easily generalized to include them.

Theory for semiparametric estimators that use ÿrst step series has been developed

in Andrews (1991) and Newey (1994a,b) among others. This section applies results

from Newey (1994b) to derive regularity conditions for semiparametric estimators of

treatment response functions.

Let = ( 1; : : : ; r) be a vector of non-negative integers where r is the dimen-

sion of X , and let | | =

r j=1

j. 6

Consider a sequence { (k)}k=1 containing all

distinct such vectors, with | | non-decreasing. For a positive integer K, let pK (X ) =

(p1(X ); : : : ; pK (X )) where pk (X ) =

r j=1

Xj (k)j .

Then,

for

K

= K(n)





a

power

series nonparametric estimator of 0 is given by

^(X ) = pK (X ) ^;

(12)

where ^=(

n i=1

pK (xi) pK (xi)

)-(

n i=1

pK (xi)zi)

and

A-

denotes

any

symmetric

gen-

eralized inverse of A.

The next three theorems present results on the asymptotic distribution of Â^ when Eq.

(12) is used in a ÿrst step to estimate 0. 7

Theorem 4.4. If Assumptions 2.1 and 4.1 hold and (i) the data are i.i.d.; (ii) is compact; (iii) X is continuously distributed with support equal to a Cartesian product of compact intervals and density bounded away from zero on its support; (iv) 0(X ) is bounded away from zero and one and is continuously di erentiable of order s; (v) g(Â) is continuous at each Â  with probability one; (vi) there is b(W ) such that for Â  , g(Â) 6 b(W ), E[b(W )] ¡  and K[(K=n)1=2 + K-s=r]  0. Then Â^p Â0.

Let (X ) = E[(@g(Â0)=@Â) |X ] where = @Ä( 0(X ))=@ = Z(1 - D)=( 0(X ))2 - D(1-Z)=(1- 0(X ))2. The function (X ) is used in the following theorem that provides su cient conditions for asymptotic normality of Â^.

Theorem 4.5. Under the assumptions of Theorem 4.4 and (i) Â0  interior( ); (ii)

there is E[supÂ:

Á¿
Â-Â0

0 such that for ¡Á @2g(Â)=@Â@Â

Â

]-¡Â0¡; (Áii,i)g(Â)nKis2

twice continuously [(K=n) + K -2s=r] 

di 0

erentiable and and for each K

6 If 0 depends only on a subset of the covariates considered in the LARF, then r is the number of covariates that enter 0.
7 Typically, we may want to trim the ÿtted values from Eq. (12) so that ^ lies between zero and one. All the results in this section still apply when the trimming function converges uniformly to the identity in the open interval between zero and one.

244

A. Abadie / Journal of Econometrics 113 (2003) 231 ­ 263

there is and MÂ

K such that nE[ = E[Ä(@2g(Â0)=@Â@Â

(X )]

) - K pK (X ) 2]K -2s=r is non-singular. Then,

n0(;Â^(-iv)Â0E)[d @Ng((0Â;0V)=)@Âwh2e]r¡e



V = MÂ-1E

Ä

@g(Â0) @Â

+

(X )(Z -

0(X ))

Ä

@g(Â0 @Â

)

+

(X )(Z -

0(X ))

MÂ-1:

The second part of condition (iii) in Theorem 4.5 deserves some comment. To minimize the order of magnitude of the mean square error in the ÿrst step we need that K-2s=r goes to zero at the same rate as K=n (see Newey, 1997). This means that, as long as (X ) is smooth enough, E[ (X ) - K pK (X ) 2] converges to zero fast enough, and undersmoothing in the ÿrst step is not necessary to achieve n-consistency in the second step. In practice, this property allows us to use cross-validation techniques to select K for the ÿrst step. This feature is not shared by semiparametric estimators that use kernel regression in a ÿrst step; those estimators usually require some undersmoothing (see Newey, 1994a; Newey and McFadden, 1994).
An estimator of V can be constructed by using the sample counterparts of its components evaluated at the estimates

V^

=

M^

-1 Â

1n n
i=1

Äi

(

^)

@gi(Â^) @Â

+

^(xi )(zi

-

^(xi))

×

Äi

(

^)

@gi(Â^) @Â

+

^(xi )(zi

-

^(xi))

M^

-1 Â

;

where M^ Â = n-1

n i=1

Äi( ^)(@2gi(Â^)=@Â@Â

).

Following

the

ideas

in

Newey

(1994b),

an

estimator of (X ) can be constructed by projecting {(@gi(Â^)=@Â) i( ^)}ni=1 on the space

spanned by {pK (xi)}ni=1:

^(xi) =

n

@gi(Â^) @Â

i( ^) pK (xi)

i=1

n

-

pK (xi) pK (xi) pK (xi):

i=1

The next theorem provides su cient conditions for consistency of V^ constructed as above.

Theorem 4.6. If the assumptions of Theorem 4.5 hold and there is Á ¿ 0 such that E[supÂ: Â-Â0 ¡Á @2g(Â)=@Â@Â 2] ¡ , then V^ p V .
Institutional knowledge about the nature of the instrument can often be used to restrict the number of covariates from X that enter the function 0. This dimension reduction can be very important to overcome the curse of dimensionality when X is highly dimensional. For example, the techniques proposed in this article can be applied to randomized experiments in which individuals do not necessarily comply with the randomized assignment for treatment, so the treatment is not ignorable, but the assignment can be used as a plausible instrument. In such case, no covariate enters 0, which is constant. However, randomization is not informative about the conditional

A. Abadie / Journal of Econometrics 113 (2003) 231 ­ 263

245

response function estimated in the second step. Therefore, a nonparametric approach based directly on conditional versions of Eqs. (3) and (4) may be highly dimensional relative to the alternative approach suggested in this section. Occasionally, we may want to reduce the dimensionality of the ÿrst step estimation by restricting some subset of the covariates in X to enter 0 parametrically. When 0 is correctly speciÿed in that way, the results of this section will still apply under a conditional version of the assumptions, and for r equal to the number of covariates that enter 0 nonparametrically (see Hausman and Newey, 1995).

5. Comparison with other IV methods

In this article, I propose a new class of IV estimators for treatment response models with covariates when a binary instrument is available. In the same context, linear 2SLS has been used to estimate treatment responses. Identiÿcation of treatment responses in linear 2SLS is often justiÿed by restricting treatment e ects to be constant among individuals (see, e.g., Heckman and Robb, 1985; Angrist, 2001). In contrast, the identiÿcation method in this article does not require such a restriction. Imbens and Angrist (1994) have shown, however that, when treatment e ects are not constant, if Assumption 2.1 holds in absence of covariates, then the treatment coe cient of 2SLS in a model without covariates recovers the average treatment e ect for compliers. This section studies whether 2SLS has a similar interpretation in models with covariates under the conditions of Assumption 2.1 (which are silently assumed to hold for the rest of this section). Linear 2SLS (with OLS as a special case), as well as the more recent nonparametric versions in Newey and Powell (1989) and Darolles et al. (2000) are discussed.

5.1. Linear models (OLS and 2SLS)

In econometrics, linear models are often used to describe the e ect of a set of

covariates on some outcome of interest. The parameters of a linear speciÿcation for

the LARF are

-1

0

D

D

D

=E

Ä

E

ÄY :

(13)

ÿ0

X

X

X

Under misspeciÿcation, ( 0; ÿ0) deÿnes the best linear least squares approximation to the LARF.
For some random sample, let ^ be a ÿrst-step estimator of 0, and ( ^; ÿ^) the analog estimator of the parameters in Eq. (13). That is,

^ ÿ^

=

1n n

i=1

di xi

Äi( ^)

di xi

-1 1 n n
i=1

di Äi( ^)yi :
xi

(14)

Clearly, when Z = D, then Äi( ^) = 1 for all i, and the equation above collapses to OLS. The conditions in Section 2.2 for Z = D imply that D is ignorable given X . In that case, E[Y |D; X ] describes average potential responses and is estimable by OLS.

246

A. Abadie / Journal of Econometrics 113 (2003) 231 ­ 263

The 2SLS estimator is widely used in linear models with endogenous regressors. In the context studied in this article, the 2SLS estimator is given by

^2SLS ÿ^2SLS

=

1n n
i=1

zi xi

di xi

-1 1 n n
i=1

zi xi yi

(15)

with probability limit

2SLS

ZD

=E

ÿ2SLS

XX

-1

Z

E

Y:

X

(16)

If X includes only a constant variable the LARF is linear, since it only depends on the binary treatment. Hence, the treatment coe cient in the LARF is 0 = E[Y1 - Y0|D1 ¿ D0]. In addition, if X includes only a constant variable, then 2SLS =cov(Y; Z)= cov(D; Z). Therefore, Eq. (2) implies that 2SLS = 0, so the 2SLS estimator of the treatment coe cient in a model without covariates has an interpretation as an estimator of the average treatment e ect for compliers. This is the LATE result of Imbens and Angrist (1994). The 2SLS estimator without covariates uses variation in D induced by Z to explain Y , and only compliers contribute to this variation. However, the comparison of Eqs. (13) and (16) shows that 2SLS is not necessarily equal to 0 in models with covariates. In 2SLS estimators with covariates, the whole population contributes to the variation in X . So the estimands do not only respond to the distribution of (Y; D; X ) for compliers. This raises the question of whether it is possible interpret linear 2SLS estimators with covariates as treatment response estimators under the assumptions used in this article. The next proposition extends the LATE result to linear models with covariates.

Proposition 5.1. Suppose that (

n i=1

xi

xi )

is

non-singular

and

that

^ in

Eq.

(14)

is

given by the OLS estimator, that is, ^(xi) = xi ^ with

^=

1 n

n

xi xi

-1

1 n

n

xi zi

:

i=1

i=1

Suppose also that (

n i=1

xiÄ^ixi )

is

positive

deÿnite

and

that

in=1(zi - xi ^)di = 0.

Then, ^2SLS = ^. Consequently, if there exists  Rl such that 0(x) = x for almost

all x in the support of X, and 2SLS and 0 exist, then 2SLS = 0.

That is, when 0(X ) is linear in X , then 2SLS = 0. 8 In general, however, the covariate coe cients (ÿ2SLS) do not have a similar interpretation. The reason is that the e ect of the treatment for always-takers may di er from the e ect of the treatment
for compliers. Once, we subtract the e ect of the treatment using 2SLS, we expect the covariate coe cients to re ect the conditional distribution of Y0 given X . Although the conditional distribution of Y0 is identiÿed for never-takers and for compliers, this is not the case for always-takers. On the other hand, if the e ect of the treatment is constant

8 The LATE result (Eq. (2)) is a special case of Proposition 5.1, because if X includes only a constant variable, then 0(X ) is constant and, therefore, linear.

A. Abadie / Journal of Econometrics 113 (2003) 231 ­ 263

247

across units, the conditional distribution of Y0 for always-takers is also identiÿed (as Y0 = Y1 - , and can be identiÿed through compliers). As a result, under constant treatment e ects, the conditional distribution of Y0 given X is identiÿed for the whole population. The next proposition is a direct consequence of this fact.

Proposition 5.2. Under constant treatment e ects (that is, Y1 - Y0 is constant), if there exists  Rl such that 0(x) = x for almost all x in the support of X , then 2SLS and ÿ2SLS are given by 2SLS = Y1 - Y0 and ÿ2SLS = arg minÿ E[{E[Y0|X ] - X ÿ}2].
Note that monotonicity is not needed here. When the e ect of the treatment is constant, the usual IV identiÿcation argument applies, and monotonicity does not play any role in identiÿcation. 9

5.2. Nonlinear models (nonparametric and semiparametric)

Newey and Powell (1989), and Darolles et al. (2000) consider a nonparametric generalization of the 2SLS estimator; Das (2001) analyzes this estimator for the case of discrete endogenous regressors. In the context of estimation of binary treatment responses, the nonparametric model of Newey and Powell (1989), Darolles et al. (2000), and Das (2001) becomes

Y = (X ) + (X )D + ;

(17)

where E[ |X; Z] = 0. It is easy to show that

(X

)

=

E[Y |X; E[D|X;

Z Z

= =

1] 1]

- -

E[Y |X; Z E[D|X; Z

= =

0] 0]

;

(18)

(X )

=

E[Y |X;

Z

=

0]E[D|X; Z E[D|X; Z

= =

1] 1]

- -

E[Y |X; Z E[D|X; Z

= =

1]E[D|X; 0]

Z

=

0] :

(19)

Under the identifying conditions of Assumption 2.1, (X ) identiÿes a conditional average treatment e ect for compliers. The interpretation of (X ) is, however, more complicated.

Proposition 5.3. The functions (X ) and (X ) in Eqs. (18) and (19) are equal to (X ) = E[Y1 - Y0|X; D1 ¿ D0];

(X ) = E[Y0|X ] + [E[Y1 - Y0|X; D0 = D1 = 1] - E[Y1 - Y0|X; D1 ¿ D0]]P(D0 = D1 = 1|X ):

9 It is well known that the result of Proposition 5.2 also holds when 0 is nonlinear as long as E[Y0|X ] is linear. See, e.g., Heckman and Robb (1985) and Angrist (2001). In that case, however, variation in X is
enough to identify the parameters of interest, since nonlinear functions of X are also valid instruments.

248

A. Abadie / Journal of Econometrics 113 (2003) 231 ­ 263

If there are no always-takers or if average treatment e ects (conditional on X ) coincide for compliers and always-takers, then (X ) recovers E[Y0|X ], and (X ) recovers E[Y1 - Y0|X; D = 1]. One special case of these conditions is when the treatment e ect, Y1 - Y0, is a deterministic function of the covariates, X . In general, however, if there is heterogeneity in treatment e ects that is not explained by the covariates, (X ) is di erent from E[Y0|X ].
If Eq. (17) is taken to be a structural model (that is, a model describing potential outcomes), then homogeneity of the treatment e ect given covariates is implied by additive separability of the error term . In that case, Y0 = (X )+ , Y1 = (X )+ (X )+ ,
(X ) = E[Y0|X ] and (X ) = Y1 - Y0. In contrast, the identiÿcation conditions adopted in this article do not restrict treatment e ects to be deterministic functions of the covariates.
Heterogeneity of treatment e ects among individuals with the same values for the covariates can be represented by structural models with a common nonadditive error term, or with di erent error terms for di erent potential outcomes. Nonparametric and semiparametric IV methods for these models can be found in Heckman (1990), Vytlacil (2000), and Lewbel (2001), among others. These articles exploit continuity and, in some cases, large support conditions for the distribution of the instruments, which do not apply to the binary IV case studied here.

6. Empirical application: the e ects of 401(k) retirement programs on savings
Since the early 1980s, tax-deferred retirement plans have become increasingly popular in the US. The aim of these programs is to increase savings for retirement through tax deductibility of the contributions to retirement accounts and tax-free accrual of interest. Taxes are paid upon withdrawal and there are penalties for early withdrawal. The most popular tax-deferred programs are Individual Retirement Accounts (IRAs) and 401(k) plans. Unlike IRAs, 401(k) plans are provided by employers. Therefore, only workers in ÿrms that o er such programs are eligible. The other important di erence between IRA and 401(k) plans is that employers may match some percentage of employees' 401(k) contributions. 10
Whether contributions to tax-deferred retirement plans represent additional savings or simply crowd out other types of savings is a central issue for the evaluation of this type of programs. This question has generated considerable research in recent years. 11 The main problem when trying to evaluate the e ects of tax-deferred retirement plans on savings is caused by individual heterogeneity. It seems likely that individuals who participate in such programs have stronger preferences for savings, so that even in the absence of the programs they would have saved more than those who do not participate. Therefore, simple comparisons of personal savings between those who participate in tax-deferred retirement plans and those who do not participate are likely to generate
10 See Employee Beneÿt Research Institute (1997) for a detailed description of tax-deferred retirement programs' history and regulations.
11 See the reviews Engen et al. (1996) and Poterba et al. (1996) for opposing interpretations of the empirical evidence on this matter.

A. Abadie / Journal of Econometrics 113 (2003) 231 ­ 263

249

estimates of the e ects of tax-deferred retirement programs that are biased upwards. Even after controlling for the e ect of observed determinants of savings (such as age or income), unobserved preferences for savings may still contaminate comparisons between participants and non-participants.
In order to overcome the individual heterogeneity problem, Poterba et al. (1994, 1995) used comparisons between those eligible and not eligible for 401(k) programs, instead of comparisons between participants and non-participants. The idea is that since 401(k) eligibility is decided by employers, unobserved preferences for savings may play a minor role in the determination of eligibility, once, we control for the e ects of observables. To support this view, Poterba et al. present evidence that eligibles and non-eligibles that fall in the same income brackets held similar amounts of assets at the outset of the program in 1984. This fact suggests that, given income, 401(k) eligibility could be unrelated to individual preferences for savings. Di erences in savings in 1991 between eligibles and non-eligibles that fall in the same income brackets are therefore interpreted as being caused by participation in 401(k) plans. Poterba et al. results show a positive e ect of participation in 401(k) programs on savings. However, since not all eligibles participate in 401(k) plans, the magnitude of the e ect is left unidentiÿed.
This section applies the methodology developed above to the study of the e ects of participation in 401(k) programs on saving behavior. As suggested by Poterba et al. (1994, 1995), eligibility is assumed to be ignorable given some observables (most importantly, income) so it can be used as an instrument for participation in 401(k) programs. 12
Note that since only eligible individuals can open a 401(k) account, monotonicity holds trivially and, as explained in Section 4.1, the estimators proposed here approximate the average treatment response function for the treated (i.e., for 401(k) participants).
The data consist of 9275 observations from the Survey of Income and Program Participation (SIPP) of 1991. These data were prepared for Poterba et al. (1996). The observational units are household reference persons aged 25 ­ 64 and spouse if present. The sample is restricted to families with at least one member employed and where no member has income from self-employment. In addition to the restrictions used in Poterba et al. (1996), here annual family income is required to fall in the $10; 000­ $200; 000 interval. The reason is that outside this interval, 401(k) eligibility in the sample is rare.
Table 1 presents descriptive statistics for the analysis sample. The treatment variable is an indicator of participation in a 401(k) plan and the instrument is an indicator of 401(k) eligibility. To study whether participation in 401(k) crowds out other types of saving, net ÿnancial assets and a binary indicator for participation in IRAs are used as outcome variables. The covariates are family income, age, marital status and family size, which are thought to be associated with unobserved preferences for savings. Table 1 also reports means and standard deviations of the variables in the sample by 401(k) participation and 401(k) eligibility status. The proportion of 401(k) eligibles in

12 The possible exogeneity of 401(k) eligibility is the subject of an exchange between Poterba et al. (1995) and Engen et al. (1994).

250

A. Abadie / Journal of Econometrics 113 (2003) 231 ­ 263

Table 1 Means and standard deviations
Entire sample By 401(k) participation

By 401(k) eligibility

Participants Non-participants Eligibles Non-eligibles

Treatment Participation in 401(k)
Instrument Eligibility for 401(k)

0.28 (0.45)
0.39 (0.49)

1.00 (0.00)

0.16 (0.37)

0.70 (0.46)

0.00 (0.00)

Outcome variables Family net ÿnancial assets 19,071.68
(63,963.84)

38,472.96 11,667.22 (79,271.08) (55,289.23)

30,535.09 11,676.77 (75,018.98) (54,420.17)

Participation in IRA

0.25 (0.44)

0.36 (0.48)

0.21 (0.41)

0.32 (0.47)

0.21 (0.41)

Covariates Family income

39,254.64 (24,090.00)

49,815.14 35,224.25 (26,814.24) (21,649.17)

47,297.81 34,066.10 (25,620.00) (21,510.64)

Age

41.08

41.51

40.91

41.48

40.82

(10.30)

(9.65)

(10.53)

(9.61)

(10.72)

Married

0.63 (0.48)

0.70 (0.46)

0.60 (0.49)

0.68 (0.47)

0.60 (0.49)

Family size

2.89 (1.53)

2.92 (1.47)

2.87 (1.55)

2.91 (1.48)

2.87 (1.56)

Note: The sample includes 9275 observations from the SIPP of 1991. The observational units are household reference persons aged 25 ­ 64, and spouse if present, with Family Income in the $10; 000­$200; 000 interval. Other sample restrictions are the same as in Poterba et al. (1995).

the sample is 39% and the proportion of 401(k) participants is 28%. The proportion of eligibles who hold 401(k) accounts is 70%. Relative to non-participants, 401(k) participants have larger holdings of ÿnancial assets and are more likely to have an IRA account. On average, 401(k) participation is associated with larger family income and a higher probability of being married. Average age and family size are similar for participants and non-participants.
Table 1 allows us to compute some simple estimators that are often used when either the treatment or the instrument can be assumed to be "as good as randomly assigned". For example, if 401(k) participation were independent of potential outcomes, we could use the simple comparison of means in Eq. (1) to estimate the average e ect of the treatment. This comparison gives $38; 473 - $11; 667 = $26; 806 for family net ÿnancial assets and 0:36 - 0:21 = 0:15 for average IRA participation. Since 401(k) participation is thought to be a ected by individual preferences for savings, these simple comparisons of means between participants and non-participants are likely to be biased upwards. If 401(k) participation was not "as good as randomly assigned" but 401(k)

A. Abadie / Journal of Econometrics 113 (2003) 231 ­ 263

251

eligibility was a valid instrument in absence of covariates, then we could use Eq. (2) to identify the average e ect of 401(k) participation on participants. Eq. (2) suggests a Wald estimator which gives ($30; 535 - $11; 677) ÷ 0:70 = $26; 940 for family net ÿnancial assets and (0:32 - 0:21) ÷ 0:70 = 0:16 for average IRA participation. These simple IV estimates are similar to those which use comparisons of means between participants and non-participants. This fact suggests that, without controlling for the e ect of covariates, 401(k) eligibility may not be a valid instrument. Indeed, the last two columns of Table 1 show systematic di erences in the averages of the covariates between 401(k) eligibles and non-eligibles. In fact, the comparison of averages for the covariates between eligibles and non-eligibles gives similar numbers to that between participants and non-participants. Eligibles have higher average income and they are more likely to be married.
To control for these di erences, the procedure proposed in this article estimates the probability of 401(k) eligibility conditional on the covariates in a ÿrst step. This ÿrst step is carried out here by using nonparametric series regression of 401(k) eligibility on income, as explained in Section 4.3.2. Another two covariates, age and marital status, are also strongly associated with eligibility. To control for the e ect of these discrete covariates I adopt an approach similar to that in Hausman and Newey (1995), including in the ÿrst step regression 80 indicator variables that control for all the combinations of age and marital status. Family size and interactions between covariates were excluded from the regression since they did not seem to explain much variation in eligibility. Fig. 1 shows the estimated conditional probability of eligibility given income (with the age­marital status variables evaluated at their means). The probability of being eligible for 401(k) is mostly increasing with income up to $170; 000 and decreasing beyond that point.
Table 2 reports the estimates of a linear model for the e ect of 401(k) participation on net ÿnancial assets. In order to describe a more accurate age proÿle for the accumulation of ÿnancial assets, the age variable enters the equation quadratically. Three di erent estimators are considered. The OLS estimates in column (1) show a strong positive association between participation in 401(k) and net ÿnancial assets given the covariates. As said above, this association may be due not only to the e ect of the treatment, but also to di erences in unexplained preferences for asset accumulation. Financial assets also appear to increase rapidly with age and income and to be lower for married couples and large families. Columns (3) and (4) in Table 2 control for the endogeneity of the treatment in two di erent ways: the conventional 2SLS estimates are shown in column (3) (with ÿrst stage results in column (2)), while column (4) shows the estimates of a linear speciÿcation for the treatment response function for the treated (which is the estimator described in Eq. (7)). In both cases, the treatment coe cient is attenuated but remains positive, suggesting that participation in 401(k) plans may increase net ÿnancial assets. The magnitude of this e ect for the treated is estimated to be $10; 800 in 1991. Note also that the coe cients of the covariates for OLS and 2SLS are similar, but that they di er from those in column (4) which are estimated for the treated. These di erences suggest that the conditional distribution of net ÿnancial assets given the covariates would still di er between 401(k) participants and non-participants in the absence of 401(k) plans.

252
0.8

A. Abadie / Journal of Econometrics 113 (2003) 231 ­ 263

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

50.000

100.000

150.000

200.000

Family Income

Fig. 1. Conditional probability of eligibility for 401(k) plan given income.

The positive e ect of 401(k) participation on net ÿnancial assets is not consistent with the view that IRAs and 401(k) plans are close substitutes. To assess the degree of substitution between these two types of saving plans, the rest of this section studies the e ect of 401(k) participation on the probability of holding an IRA account. 13
The ÿrst three columns of Table 3 report the coe cients of linear probability models for IRA participation on 401(k) participation and the covariates. The OLS estimates in column (1) show that 401(k) participation is associated with an increase of 5.7% in the probability of holding an IRA account, once we control for the e ect of the covariates in a linear fashion. The estimated e ect of 401(k) participation decreases when we instrument this variable with 401(k) eligibility. The 2SLS estimates in column (2) show a 2.7% increase in the probability of IRA participation due to participation in a 401(k) plan. Column (3) uses the methodology proposed in this article to estimate a linear speciÿcation for the treatment response function of participants. The e ect of 401(k) participation on the probability of holding an IRA account is further reduced and it is no longer signiÿcant. 14
13 Note that substitution between 401(k) and IRA cannot be fully explained through participation in these programs. Even if 401(k) participants hold IRA accounts, 401(k) participation may reduce IRA contributions. Unfortunately, the SIPP only reports participation in IRA and not contributions.
14 Inference throughout this section uses the conventional 5% level of signiÿcance.

A. Abadie / Journal of Econometrics 113 (2003) 231 ­ 263

253

Table 2 Linear response functions for family net ÿnancial assets (dependent variable: family net ÿnancial assets (in $))

Endogenous treatment

Two stage least squares

Ordinary least squares (1)

First stage (2)

Second stage (3)

Least squares treated (4)

Participation in 401(k)

13,527.05 (1,810.27)

9,418.83 (2,152.89)

10,800.25 (2,261.55)

Constant

-23; 549:00 (2,178.08)

-0:0306 (0.0087)

-23; 298:74 (2,167.39)

-27; 133:56 (3,212.35)

Family income (in thousand $)

976.93 (83.37)

0.0013 (0.0001)

997.19 (83.86)

982.37 (106.65)

Age (minus 25)

-376.17 (236.98)

-0:0022 (0.0010)

-345:95 (238.10)

312.30 (371.76)

Age (minus 25) squared

38.70 (7.67)

0.0001 (0.0000)

37.85 (7.70)

24.44 (11.40)

Married

-8; 369:47 (1,829.93)

-0:0005 (0.0079)

-8; 355:87 (1,829.67)

-6; 646:69 (2,742.77)

Family size

-785:65 (410.78)

0.0001 (0.0024)

-818:96 (410.54)

-1; 234:25 (647.42)

Eligibility for 401(k)

0.6883 (0.0080)

Note: The dependent variable in column (2) is Participation in 401(k). The sample includes 9275 observations from the SIPP of 1991. The observational units are household reference persons aged 25 ­ 64, and spouse if present, with Family Income in the $10; 000­$200; 000 interval. Other sample restrictions are the same as in Poterba et al. (1995). Robust standard errors are reported in parentheses.

Linear speciÿcations are often criticized when the dependent variable is binary. The reason is that linear response functions may take values outside the [0; 1] range of a conditional probability function. Nonlinear response functions into [0; 1], such as the Probit response function, are customarily adopted for binary choice models. Columns (4) ­ (9) in Table 3 report marginal e ect coe cients (partial derivatives) of a Probit response function for an indicator of having an IRA account on 401(k) participation and the covariates. Marginal e ects are evaluated at the mean of the covariates for the treated. 15 Columns (4) and (5) present the results obtained using simple Probit and

15 For binary explanatory variables (Participation in 401(k) and Married) the table reports the change in the response function due to a change in the binary variable, with other the explanatory variables evaluated at the mean for the treated.

254

Table 3 Linear and probit response functions for IRA participation marginal e ects (dependent variable: IRA account)

Linear response

Probit response

Endogenous treatment

Endogenous treatment

Least sq.

Two stage least sq.

Least sq. treated

Probit

Least sq.

Bivariate probit

Probit treated

Participation in 401(k)

(1)
0.0569 (0.0103)

(2)
0.0274 (0.0132)

(3)
0.0253 (0.0131)

(4)
0.0712 (0.0121)

(5)
0.0699 (0.0126)

(6)
0.0407 (0.0156)

(7)
0.0358 (0.0161)

Least sq. treated
(8)
0.0264 (0.0172)

Least sq. treated interact (9)
0.0279 (0.0170)

A. Abadie / Journal of Econometrics 113 (2003) 231 ­ 263

Family income (in thousand $)

0.0059 (0.0002)

0.0060 (0.0002)

0.0060 (0.0003)

0.0069 (0.0003)

0.0070 (0.0003)

0.0069 (0.0003)

0.0069 (0.0004)

0.0072 (0.0005)

0.0069 (0.0005)

Age (minus 25)

0.0074 (0.0014)

0.0076 (0.0014)

0.0119 (0.0025)

0.0149 (0.0022)

0.0153 (0.0023)

0.0147 (0.0021)

0.0183 (0.0034)

0.0207 (0.0037)

0.0199 (0.0037)

Age (minus 25) squared

0.0000 (0.0000)

0.0000 (0.0000)

-0:0001 (0.0001)

-0:0001 (0.0001)

-0:0001 (0.0001)

-0:0001 (0.0001)

-0:0002 (0.0001)

-0:0002 (0.0001)

-0:0002 (0.0001)

Married

0.0312 (0.0110)

0.0313 (0.0110)

0.0440 (0.0184)

0.0590 (0.0152)

0.0477 (0.0166)

0.0577 (0.0148)

0.0627 (0.0231)

0.0535 (0.0244)

0.0508 (0.0237)

Family size

-0:0264 (0.0032)

-0:0266 (0.0032)

-0:0340 (0.0053)

-0:0424 (0.0050)

-0:0403 (0.0056)

-0:0415 (0.0049)

-0:0472 (0.0075)

-0:0480 (0.0082)

-0:0461 (0.0083)

Note: For binary variables (Participation in 401(k) and Married) the table reports the change in the response function due to a change in the indicator variable, with the rest of the covariates evaluated at the mean for the treated. For non-binary variables the table reports partial derivatives evaluated at the mean of the covariates for the treated. The sample includes 9275 observations from the SIPP of 1991. The observational units are household reference persons aged 25 ­ 64, and spouse if present, with Family Income in the $10; 000­$200; 000 interval. Other sample restrictions are the same as in Poterba et al. (1995). Robust standard errors are reported in parentheses.

A. Abadie / Journal of Econometrics 113 (2003) 231 ­ 263

255

Nonlinear Least Squares estimators (i.e., treating 401(k) participation as exogenous). These results show that, after controlling for the e ect of the covariates with a Probit speciÿcation, participation in 401(k) is associated with an increase of 7% in the probability of holding an IRA account. However, this association cannot be interpreted as re ecting only the e ect of the treatment, because simple Probit and Nonlinear Least Squares estimators do not correct for endogeneity of 401(k) participation.
The Bivariate Probit model provides a simple way to deal with an endogenous binary regressor in a dichotomous response equation. This model is based on a simultaneous equations system which completely speciÿes a joint conditional distribution for the endogenous variables. 16 The results from applying the Bivariate Probit model to the present empirical example are contained in column (6) of Table 3; they show an important attenuation of the treatment coe cient even though it remains signiÿcant. However, the validity of these estimates depends on the parametric assumptions on which the Bivariate Probit model is based.
The last three columns of Table 3 use the techniques introduced in this article to estimate a Probit functional form for the treatment response function for the treated. Column (7) uses the Probit function as a literal speciÿcation and estimates the model by Maximum Likelihood, as described in Eq. (10). The estimated e ect of the treatment is smaller than the Bivariate Probit estimate in column (6), even though it remains signiÿcant.
Column (8) reports least squares estimates of the Probit speciÿcation for the average treatment response for the treated using a Probit function; this is the estimator described in Eq. (8). In this case, the estimated e ect of participation in 401(k) on the probability of holding an IRA account vanishes.
Column (9) reports marginal e ects for a model with interactions. Consider the following model for compliers:

Y = 1{ÁD + X ÿ - U ¿ 0};

where U is normally distributed with zero mean and variance equal to

2 U

and

is

independent of D and X , and Á is normally distributed with mean equal to and

variance equal to

2 Á

and

is

independent

of

U,

D

and

X.

Then,

it

can

be

easily

seen

that

E[Y |D; X; D1 ¿ D0] = ( 0D + (1 + 0D)X ÿ0);

(20)

where 0 = = , ÿ0 = ÿ= U , 0 = ( U = - 1) and =

2 U

+

Á2. Column (9) is based

on least squares estimation of the model in Eq. (20). Under misspeciÿcation of Eq.

(20), the estimates in column (9) can still be interpreted as those produced by the best

least squares approximation to the treatment response function for 401(k) participants

that use the speciÿcation in Eq. (20). This alternative speciÿcation of the functional

form is more exible than the speciÿcation in previous columns since it includes an

interaction term between the treatment indicator and the covariates. The results do

16 For the problem studied in this article, the Bivariate Probit model speciÿes Y = 1{ 0D + X ÿ0 - UY ¿ 0} and D = 1{ 0Z + X 0 - UD ¿ 0}, where 1{A} denotes the indicator function for the event A and the error terms UY and UD have a joint normal distribution. See Maddala (1983, p. 122) for details.

256

A. Abadie / Journal of Econometrics 113 (2003) 231 ­ 263

not vary much with respect to column (8), suggesting that this particular structure of random coe cients is not very informative of the treatment response of 401(k) participants relative to the more basic Probit speciÿcation.
On the whole, Table 3 shows that IV methods attenuate the estimated e ect of 401(k) participation on the probability of holding an IRA account. This is consistent with the view that estimators which do not control for endogeneity of 401(k) participation are biased upwards. However, Table 3 does not o er evidence of displacement of IRA accounts.
Finally, it is worth noticing that the simple estimates produced by using the unconditional means in Table 1 are much bigger than those in Tables 2 and 3, which control for the e ect of observed covariates. This suggests that much of the heterogeneity in saving preferences which a ects our estimators can be explained by observed individual characteristics. This example illustrates the important e ect that conditioning on covariates may have on IV estimates of treatment parameters.

7. Conclusions
This article introduces a new class of instrumental variable estimators of treatment e ects for linear and nonlinear models with covariates. The most distinctive feature of the approach proposed in this article is that, while identiÿcation is based on nonparametric assumptions, it can be used to estimate parsimonious parameterizations of an average treatment response function of interest. In the context of the previous literature on IV models for treatment e ects, this article generalizes existing identiÿcation results to situations where the ignorability of the instrument is confounded by observed covariates. The estimators proposed in this article are demonstrated by using eligibility for 401(k) plans as an instrumental variable to estimate the e ect of participation in 401(k) programs on saving behavior. The results suggest that participation in 401(k) does not crowd out savings in ÿnancial assets. On the contrary, participation in 401(k) seems to have a positive e ect on ÿnancial assets accumulation and a small or null e ect on the probability of holding an IRA account.
In principle, it is straightforward to generalize the results of this article to non-binary and non-scalar treatments and instruments by considering separately quadruples of two treatment levels and two instrument levels: {d; d ; z; z }. However, the composition of compliers may change with changes of any of the components in {d; d ; z; z }, creating an aggregation problem. This constitutes an interesting topic for future research.

Acknowledgements
An earlier version of this article was a chapter of my Ph.D. dissertation at MIT. I am indebted to Joshua Angrist and Whitney Newey for their support, insight and encouragement on this project. I also thank Jinyong Hahn, Jerry Hausman, Guido Imbens, Steve Pischke, Jim Poterba, Donald Rubin and seminar participants at Florida, Harvard, Michigan, MIT, Northwestern, Princeton, UC-San Diego and the 1999 NSF

A. Abadie / Journal of Econometrics 113 (2003) 231 ­ 263

257

Symposium on Quasi-Experimental Methods at UC-Berkeley for helpful comments and discussions, and Jim Poterba and Steve Venti for providing me with the data for the empirical application. Comments by the editor, an associate editor and two referees have led to signiÿcant improvements in contents and presentation. Financial support from the Bank of Spain is gratefully acknowledged.

Appendix A.

Proof of Lemma 3.1. Under Assumption 2.1
P(D1 ¿ D0|X ) = 1 - P(D1 = D0 = 0|X ) - P(D1 = D0 = 1|X )
= 1 - P(D1 = D0 = 0|X; Z = 1) - P(D1 = D0 = 1|X; Z = 0)
= 1 - P(D = 0|X; Z = 1) - P(D = 1|X; Z = 0)
= P(D = 1|X; Z = 1) - P(D = 1|X; Z = 0)
= E[D|X; Z = 1] - E[D|X; Z = 0]:
The ÿrst and third equalities hold by monotonicity. The second equality holds by independence of Z. The last two equalities hold because D is binary. By monotonicity (D1 - D0) is binary. So, the second part of Assumption 2.1(iii) can be expressed as P(D1 - D0 = 1|X ) ¿ 0 or P(D1 ¿ D0|X ) ¿ 0.

Proof of Theorem 3.1. Monotonicity implies

E[g(Y;

D;

X

)|X;

D1

¿

D0]

=

P(D1

1 ¿

D0|X

)

{E[g(Y;

D;

X

)|X

]

- E[g(Y; D; X )|X; D1 = D0 = 1]P(D1 = D0 = 1|X )

- E[g(Y; D; X )|X; D1 = D0 = 0]P(D1 = D0 = 0|X )}:

Since Z is ignorable and independent of the potential outcomes given X , and since we assume monotonicity, the above equation can be written as

E[g(Y;

D;

X

)|X;

D1

¿

D0]

=

P(D1

1 ¿

D0|X

)

{E[g(Y;

D;

X

)|X

]

- E[g(Y; D; X )|X; D = 1; Z = 0]P(D = 1|X; Z = 0)

- E[g(Y; D; X )|X; D = 0; Z = 1]P(D = 0|X; Z = 1)}:

Consider also

E[D(1 - Z)g(Y; D; X )|X ] = E[g(Y; D; X )|X; D = 1; Z = 0]P(D = 1; Z = 0|X )

= E[g(Y; D; X )|X; D = 1; Z = 0]

×P(D = 1|X; Z = 0)P(Z = 0|X )

258

A. Abadie / Journal of Econometrics 113 (2003) 231 ­ 263

and E[Z(1 - D)g(Y; D; X )|X ] = E[g(Y; D; X )|X; D = 0; Z = 1]P(D = 0; Z = 1|X )

= E[g(Y; D; X )|X; D = 0; Z = 1]

×P(D = 0|X; Z = 1)P(Z = 1|X ):

Under Assumption 2.1(iii), we can combine the last three equations in

E[g(Y; D; X )|X; D1 ¿ D0]

=

P(D1

1 ¿

D0|X

)

E

g(Y; D; X )

1

-

D(1 - Z) P(Z = 0|X )

-

Z(1 - D) P(Z = 1|X )

X:

Applying Bayes' theorem and integrating yields

E[g(Y; D; X )|X; D1 ¿ D0] dP(X |D1 ¿ D0)

=

P(D1

1 ¿

D0)

E g(Y; D; X )

1

-

D(1 - Z) P(Z = 0|X )

-

Z(1 - D) P(Z = 1|X )

or

E[g(Y;

D; X )|D1

¿

D0]

=

P(D1

1 ¿

D0) E[Äg(Y;

D; X )]:

This proves part (a) f the theorem. To prove part (b) note that

X dP(X )

E[g(Y; X )(1 - D)|X; D1 ¿D0] = E[g(Y0; X )|D = 0; X; D1 ¿D0]P(D = 0|X; D1 ¿D0)

= E[g(Y0; X )|Z = 0; X; D1 ¿D0]P(Z = 0|X; D1 ¿D0)

= E[g(Y0; X )|X; D1 ¿ D0]P(Z = 0|X ):

Where the second equality holds because for compliers D = Z. The last equality holds by independence of Z. The proof of parts (b) and (c) of the theorem follows now easily. For part (b), note that,

E[g(Y0; X )|X; D1 ¿ D0] = E

g(Y;

X)

(1 - D) P(Z = 0|X )

X; D1 ¿ D0

=

P(D1

1 ¿

D0|X

)

E

Ä

(1 P(Z

- =

D) 0|X

)

g(Y;

X

)

X

=

P(D1

1 ¿

D0|X

)

E[Ä0g(Y;

X

)|X

]:

Integration of this equation yields the desired result. The proof of part (c) of the

theorem is analogous to that of part (b). By construction, the theorem also holds conditioning on X.

Proof of Theorem 4.1. Theorem 3.1 implies that
Â0 = arg min E[Ä(D; Z; 0(X ))g(Y; D; X ; Â)]
Â

A. Abadie / Journal of Econometrics 113 (2003) 231 ­ 263

259

and that the minimum is unique. Denote g(Â) = g(Y; D; X ; Â) and Ä( ) = Ä(D; Z; (X; )). By (iii) and (v), for close enough to 0, the absolute value of Ä( ) is bounded by some constant and Ä( )g(Â) is continuous with probability one; by (iv) this happens with probability approaching one (w.p.a.1). This, along with the second part of (v) and Lemma 2.4 in Newey and McFadden (1994), implies

sup
(Â; ) × ~

1 n

n

Äi( )gi(Â) - E[Ä( )g(Â)]

p 0;

i=1

(A.1)

where ~ is any compact neighborhood of 0 contained in {  Rl: - 0 ¡ Á} for Á in (iii), Äi( ) = Ä(di; zi; (xi; )) and gi(Â) = g(yi; di; xi; Â). Also, E[Ä( )g(Â)] is continuous at each (Â; ) in × ~. By the Triangle Inequality,

sup
Â

1 n

n

Äi( ^)gi(Â) - E[Ä( 0)g(Â)]

i=1

6 sup
Â

1 n

n

Äi( ^)gi(Â) - E[Ä( ^)g(Â)]

i=1

+ sup ||E[Ä( ^)g(Â)] - E[Ä( 0)g(Â)]|| :
Â

(A.2)

The ÿrst term of the right-hand side of (A.2) is op(1) by (A.1); the second term is op(1) by (iv) and uniform continuity of E[Ä( )g(Â)] on × ~ compact. This result,
along with (i) and (ii) and Theorem 2.1 in Newey and McFadden (1994), implies consistency of Â^.

Proof of Theorem 4.2. By (i), (ii) and consistency of Â^, with probability approaching one

0 = 1n

n

Äi

(

^)

@gi(Â^) @Â

=

1n

n

Äi

(

^)

@gi (Â0 @Â

)

+

1n n

Äi

(

^)

@2 gi (Â~) @Â@Â

n(Â^-Â0);

i=1

i=1

i=1

where Â~ - Â0 6 Â^ - Â0 and Â~ possibly di ers between rows of @2gi(·)=@Â@Â . As

Ä( ^) is bounded w.p.a.1, then by (ii) and Lemma 4.3 in Newey and McFadden (1994),

we have that n-1

n i=1

Äi( ^)(@2gi(Â~)=@Â@Â

)p MÂ,

which

is

non-singular

by

(iv).

Now,

the second part of (ii) implies that w.p.a.1

n(Â^ - Â0) = -(MÂ-1 + op(1))

1n

n

Äi (

0

)

@gi (Â0 ) @Â

i=1

+

1 n @gi(Â0) @Äi( ~)

n

@Â @

 n( ^ - 0) :

i=1

From (ii), (iv) and Holder's Inequality, it follows that E[sup  ~ (@g(Â0)=@Â)

(@Ä( 0)=@ ) ] ¡ . So, by using the same argument as for MÂ, n-1

n i=1

(@gi

(Â0)=@Â)

(@Ä( ~)=@ )p M . Then, by (iii) and the ÿrst part of (iv), Â^ is asymptotically linear

with in uence function equal to -MÂ-1{Ä(@g(Â0)=@Â) + M }, and the result of the

theorem follows.

260

A. Abadie / Journal of Econometrics 113 (2003) 231 ­ 263

Proof of Theorem 4.3. From (i) it is easy to show that n-1

n i=1

Ä( ^) @g(Â^)=@Â -

Ä( 0) @g(Â0)=@Â 2p 0. The result now follows from the application of the Triangle and

Holder's Inequalities.

Proof of Theorem 4.4. By the Triangle Inequality,

sup
Â

1 n

n

Äi( ^)gi(Â) - E[Ä( 0)g(Â)]

i=1

6 sup
Â

1 n

n

(Äi( ^) - Äi( 0))gi(Â)

i=1

+ sup
Â

1 n

n

Äi( 0)gi(Â) - E[Ä( 0)g(Â)]

:

i=1

(A.3)

By (iv), (v), (vi) and Lemma 2.4 in Newey and McFadden (1994), the second term

in Eq. (A.3) is op(1) and E[Ä( 0)g(Â)] is continuous. It can be easily seen that for

close enough to 0, |Ä( ) - Ä( 0)| 6 C| - 0| (where | · | stands for the supremum

norm) for some constant C. By Theorem 4 of Newey (1997), | ^ - 0|p 0. From (vi),

supÂ

n-1

n i=1

(Äi

(

^)

-

Äi

(

0 ))gi (Â)

6C|^ -

0|n-1

n i=1

b(wi

)

=

op(1).

Then,

the

result follows easily from Theorem 2.1 in Newey and McFadden (1994).

Proof of Theorem 4.5. From (i), (ii) and consistency of Â^, w.p.a.1 we have

0

=

1 n

n

Äi

(

^)

@gi(Â^) @Â

=

1 n

n

Äi

(

^)

@gi (Â0 ) @Â

+

1 n

n

Äi (

^)

@2 gi (Â~) @Â@Â

n(Â^-Â0):

i=1

i=1

i=1

Using an argument similar to that of the proof of Theorem 6.1 in Newey (1994b), it can be shown that (iii) implies

1 n

n

Äi (

^)

@gi (Â0 ) @Â

=

1 n

n

i=1

i=1

Äi (

0)

@gi (Â0 @Â

)

+

(xi)(zi -

0 (xi ))

+ op(1):

To show consistency of the Hessian, note that

1 n

n

Äi (

^)

@2 gi (Â~) @Â@Â

=

1 n

n

Äi (

0

)

@2 gi (Â~) @Â@Â

+

1 n

n

(Äi( ^) - Äi(

0

))

@2 gi (Â~) @Â@Â

:

(A.4)

i=1

i=1

i=1

By (ii) and Lemma 4.3 in Newey and McFadden (1994), we have that n-1

n i=1

Äi (

0)

(@2gi(Â~)=@Â@Â )p MÂ which is non-singular by (iv). Also, with probability approaching

one, we have

1 n

n

(Äi( ^) - Äi(

0))

@2 gi (Â~) @Â@Â

i=1

6C|^ -

0|

1 n

n i=1

Â:

sup
Â-Â0 ¡Á

@2 gi (Â) @Â@Â

;

so the second term of Eq. (A.4) is op(1). Then, from (iv), Â^ is asymptotically linear with in uence function -MÂ-1{Ä(@g(Â0)=@Â) + (Z - 0)} and the result of the theorem holds.

A. Abadie / Journal of Econometrics 113 (2003) 231 ­ 263

261

Proof of Theorem 4.6. Using E[supÂ: Â-Â0 ¡Á @2g(Â)=@Â@Â 2] ¡  and conditions of

Theorem 4.5, it is easy to show that n-1

n i=1

Äi( ^)@gi(Â^)=@Â-Äi( 0)@gi(Â0)=@Â 2 p 0.

To show n-1

n i=1

^i(xi)(zi - ^(xi)) -

i(xi)(zi - 0(xi)) 2p 0 an argument similar to

that of the proof of Theorem 6.1 in Newey (1994) applies. However, for the class

of estimators introduced in this article we have that D(W; ~; Â; ) - D(W; ~; Â0; 0) 6 C @2g(Â~)=@Â@Â Â - Â0 | ~| for close enough to 0, ~  G (where G is the set of all square-integrable functions of X ) and Â~ - Â0 6 Â - Â0 . The fact that there is

a function dominating D(W; ~; Â; ) - D(W; ~; Â0; 0) that does not depend on | - 0|

allows us to specify conditions on the rate of growth of K that are weaker than those

in Assumption 6.7 of Newey (1994b). These conditions are implied by the assumptions

of Theorem 4.5.

Proof of Proposition 5.1. It can be easily seen that Ä^i(di - xi ^) = (zi - xi ^). Then,

n

n

0 = xi(zi - xi ^) = xiÄ^i(di - xi ^):

i=0

i=0

So,

n

-1 n

^=

xi Ä^i xi

xi Ä^i di :

i=1

i=1

Using this result along with Eq. (14) we have

^

=

( (

diÄ^iyi) - ( diÄ^idi) - (

diÄ^ixi )( diÄ^ixi )(

xiÄ^ixi )-1( xiÄ^ixi )-1(

xi Ä^i yi ) xi Ä^i di )

=

(di (di

- -

xi xi

^)Ä^i yi ^)Ä^i di

=

(zi (zi

- -

xi xi

^)yi ^)di

=

^2SLS:

The last results follows from a Weak Law of Large Numbers for the estimators in equations (14) and (15).

Proof of Proposition 5.2. Consider ( 0; ÿ0) given in the proposition, that is 0 =Y1 -Y0 and ÿ0 = arg minÿ E[(E[Y0|X ] - X ÿ)2]. Then, E[X (Y0 - X ÿ0)] = 0. Let us show that the orthogonality conditions of 2SLS hold for ( 0; ÿ0). Note that
Y - 0D - X ÿ0 = Y0 + (Y1 - Y0 - 0)D - X ÿ0 = Y0 - X ÿ0: By Assumption 2.1, Z is independent of Y0 given X . Then, if 0 is linear
E[Z(Y - 0D - X ÿ0)] = E[Z(Y0 - X ÿ0)] = E[X (Y0 - X ÿ0)] = 0 and
E[X (Y - 0D - X ÿ0)] = E[X (Y0 - X ÿ0)] = 0: So, the result of the proposition holds.

262

A. Abadie / Journal of Econometrics 113 (2003) 231 ­ 263

Proof of Proposition 5.3. The result for (X ) comes from Eq. (2). The result for (X ) can be derived as follows:

(X

)

=

E[Y1D0

+

Y0(1

-

D0)|X

]E[D1|X E[D1|X

] ]

- -

E[Y1D1 E[D0|X

+ ]

Y0(1

-

D1)|X

]E[D0|X

]

=

E[Y0|X ]

+

E[(Y1

-

Y0)D0|X

]E[D1|X E[D1|X

] ]

- -

E[(Y1 - Y0)D1|X E[D0|X ]

]E[D0|X

]

=

E[Y0|X

]

+

E[(Y1

-

Y0)D0|X

]

-

E[(Y1

-

Y0)(D1 - D0)|X E[D1 - D0|X ]

]E[D0|X

]

= E[Y0|X ] + {E[Y1 - Y0|X; D0 = 1] - E[Y1 - Y0|X; D1 ¿ D0]}P(D0 = 1|X ):

And the result holds by monotonicity.

References
Abadie, A., 2002. Bootstrap tests for distributional treatment e ects in instrumental variable models. Journal of the American Statistical Association 97, 284­292.
Abadie, A., Angrist, J.D., Imbens, G.W., 2002. Instrumental variables estimates of the e ect of subsidized training on the quantiles of trainee earnings. Econometrica 70, 91­117.
Andrews, D.W.K., 1991. Asymptotic normality of series estimators for nonparametric and semiparametric regression models. Econometrica 59, 307­345.
Angrist, J.D., 2001. Estimation of limited dependent variable models with dummy endogenous regressors: simple strategies for empirical practice. Journal of Business and Economic Statistics 19, 1­16.
Angrist, J.D., Imbens, G.W., 1995. Two-stage least squares estimation of average causal e ects in models with variable treatment intensity. Journal of the American Statistical Association 90, 431­442.
Angrist, J.D., Imbens, G.W., Rubin, D.B., 1996. Identiÿcation of causal e ects using instrumental variables. Journal of the American Statistical Association 91, 444­472.
Card, D., 1993. Using geographic variation in college proximity to estimate the return to schooling. Working Paper 4483, National Bureau of Economic Research.
Darolles, S., Florens, J.P., Renault, E., 2000. Nonparametric instrumental regression. Working Paper 2000-17, Centre de Recherche en EÃ conomie et Statistique.
Das, M., 2001. Instrumental variables estimation for nonparametric models with discrete endogenous regressors. Mimeo, Columbia University, Department of Economics.
Employee Beneÿt Research Institute, 1997. Fundamentals of Employee Beneÿt Programs. EBRI, Washington, DC.
Engen, E.M., Gale, W.G., Scholz, J.K., 1994. Do saving incentives work? Brookings Papers on Economic Activity 1, 85­180.
Engen, E.M., Gale, W.G., Scholz, J.K., 1996. The illusory e ects of saving incentives on saving. Journal of Economic Perspectives 10, 113­138.
Goldberger, A.S., 1983. Abnormal selection bias. In: Karlin, S., Amemiya, T., Goodman, L. (Eds.), Studies in Econometrics, Time Series and Multivariate Statistics. Academic Press, New York.
Hausman, J.A., Newey, W.K., 1995. Nonparametric estimation of exact consumers surplus and deadweight loss. Econometrica 63, 1445­1476.
Heckman, J.J., 1990. Varieties of selection bias. American Economic Review 80, 313­318. Heckman, J.J., Robb, R., 1985. Alternative methods for evaluating the impact of interventions. In: Heckman,
J.J., Singer, B. (Eds.), Longitudinal Analysis of Labor Market Data. Cambridge University Press, New York. Heckman, J.J., Vytlacil, E.J., 1999. Local instrumental variables and latent variable models for identifying and bounding treatment e ects. Proceedings of the National Academy of Sciences 96, 4730­4734.

A. Abadie / Journal of Econometrics 113 (2003) 231 ­ 263

263

Hirano, K., Imbens, G.W., Rubin, D.B., Zhou, X., 2000. Assessing the e ect of an in uenza vaccine in an encouragement design. Biostatistics 1, 69­88.
Imbens, G.W., Angrist, J.D., 1994. Identiÿcation and estimation of local average treatment e ects. Econometrica 62, 467­476.
Imbens, G.W., Rubin, D.B., 1997. Estimating outcome distributions for compliers in instrumental variable models. Review of Economic Studies 64, 555­574.
Lewbel, A., 2001. Two stage least squares estimation of endogenous sample selection models. Mimeo, Boston College, Department of Economics.
Little, R.J., Yau, L.H.Y., 1998. Statistical techniques for analyzing data from prevention trials: treatment of no-shows using Rubin's causal model. Psychological Methods 3, 147­159.
Maddala, G.S., 1983. Limited-dependent and qualitative variables in econometrics. In: Econometric Society Monograph, No. 3. Cambridge University Press, Cambridge.
Manski, C.F., 1988. Analog Estimation Methods in Econometrics. Champman & Hall, New York. Manski, C.F., 1997. Monotone treatment response. Econometrica 65, 1311­1334. Manski, C.F., 2000. Identiÿcation problems and decisions under ambiguity: empirical analysis of treatment
response and normative analysis of treatment choice. Journal of Econometrics 95, 415­442. Manski, C.F., Pepper, J.V., 2000. Monotone instrumental variables: with an application to the returns to
schooling. Econometrica 68, 997­1010. Newey, W.K., 1994a. Series estimation of regression functionals. Econometric Theory 10, 1­28. Newey, W.K., 1994b. The asymptotic variance of semiparametric estimators. Econometrica 62, 1349­1382. Newey, W.K., 1997. Convergence rates and asymptotic normality for series estimators. Journal of
Econometrics 79, 147­168. Newey, W.K., McFadden, D., 1994. Large sample estimation and hypothesis testing. In: Engle, R.F.,
McFadden, D. (Eds.), Handbook of Econometrics, Vol. 4. Elsevier Science, Amsterdam. Newey, W.K., Powell, J.L., 1989. Nonparametric instrumental variables estimation. Mimeo, MIT, Department
of Economics. Poterba, J.M., Venti, S.F., Wise, D.A., 1994. 401(k) plans and tax-deferred savings. In: Wise, D. (Ed.),
Studies in the Economics of Aging. University of Chicago Press, Chicago. Poterba, J.M., Venti, S.F., Wise, D.A., 1995. Do 401(k) contributions crowd out other personal saving?
Journal of Public Economics 58, 1­32. Poterba, J.M., Venti, S.F., Wise, D.A., 1996. Personal retirement saving programs and asset accumulation:
reconciling the evidence. Working Paper 5599, National Bureau of Economic Research. Roehrig, C.S., 1988. Conditions for identiÿcation in nonparametric and parametric models. Econometrica 56,
433­447. Rubin, D.B., 1974. Estimating causal e ects of treatments in randomized and nonrandomized studies. Journal
of Educational Psychology 66, 688­701. Rubin, D.B., 1977. Assignment to treatment group on the basis of a covariate. Journal of Educational
Statistics 2, 1­26. Vytlacil, E.J., 2000. Semiparametric identiÿcation of the average treatment e ect in nonseparable models.
Mimeo, Stanford University, Department of Economics. Vytlacil, E.J., 2002. Independence, monotonicity, and latent index models: an equivalency result.
Econometrica 70, 331­341. White, H., 1981. Consequences and detection of misspeciÿed nonlinear regression models. Journal of the
American Statistical Association 76, 419­433. White, H., 1982. Maximum likelihood estimation of misspeciÿed models. Econometrica 50, 1­25.

