Econometrica, Vol. 84, No. 2 (March, 2016), 781­807
NOTES AND COMMENTS
MATCHING ON THE ESTIMATED PROPENSITY SCORE
BY ALBERTO ABADIE AND GUIDO W. IMBENS1
Propensity score matching estimators (Rosenbaum and Rubin (1983)) are widely used in evaluation research to estimate average treatment effects. In this article, we derive the large sample distribution of propensity score matching estimators. Our derivations take into account that the propensity score is itself estimated in a first step, prior to matching. We prove that first step estimation of the propensity score affects the large sample distribution of propensity score matching estimators, and derive adjustments to the large sample variances of propensity score matching estimators of the average treatment effect (ATE) and the average treatment effect on the treated (ATET). The adjustment for the ATE estimator is negative (or zero in some special cases), implying that matching on the estimated propensity score is more efficient than matching on the true propensity score in large samples. However, for the ATET estimator, the sign of the adjustment term depends on the data generating process, and ignoring the estimation error in the propensity score may lead to confidence intervals that are either too large or too small.
KEYWORDS: Matching estimators, propensity score matching, average treatment effects, causal inference, program evaluation.

1. INTRODUCTION
PROPENSITY SCORE MATCHING ESTIMATORS (Rosenbaum and Rubin (1983)) are widely used to estimate treatment effects.2 Rosenbaum and Rubin (1983) defined the propensity score as the conditional probability of assignment to a treatment given a vector of covariates. Suppose that adjusting for a set of covariates is sufficient to eliminate confounding. The key insight of Rosenbaum and Rubin (1983) is that adjusting only for the propensity score is also sufficient to eliminate confounding. Relative to matching directly on the covariates, propensity score matching has the advantage of reducing the dimensionality of matching to a single dimension. This greatly facilitates the matching process

1We are grateful to the editor and three referees for helpful comments, to Ben Hansen, Judith Lok, James Robins, Paul Rosenbaum, Donald Rubin, and participants in many seminars for comments and discussions, and to Jann Spiess for expert research assistance. Financial support by the NSF through Grants SES 0820361 and SES 0961707 is gratefully acknowledged.
2Following the terminology in Abadie and Imbens (2006), the term "matching estimator" is reserved in this article to estimators that match each unit (or each unit of some sample subset, e.g., the treated) to a small number of units with similar characteristics in the opposite treatment arm. Thus, our discussion does not refer to regression imputation methods, like the kernel matching method of Heckman, Ichimura, and Todd (1998), which use a large number of matches per unit and nonparametric smoothing techniques to consistently estimate unit-level regression values under counterfactual treatment assignments. See Hahn (1998), Heckman, Ichimura, and Todd (1998), Imbens (2004), and Imbens and Wooldridge (2009) for a discussion of such estimators.

© 2016 The Econometric Society

DOI: 10.3982/ECTA11293

782

A. ABADIE AND G. W. IMBENS

because units with dissimilar covariate values may nevertheless have similar values for their propensity scores.
In observational studies, propensity scores are not known, so they have to be estimated prior to matching. In spite of the great popularity that propensity score matching methods have enjoyed since they were proposed by Rosenbaum and Rubin in 1983, their large sample distribution has not yet been derived for the case when the propensity score is estimated in a first step.3 A possible reason for this void in the literature is that matching estimators are non-smooth functionals of the distribution of the matching variables, which makes it difficult to establish an asymptotic approximation to the distribution of matching estimators when a matching variable is estimated in a first step. This has motivated the use of bootstrap standard errors for propensity score matching estimators. However, recently it has been shown that the bootstrap is not, in general, valid for matching estimators (Abadie and Imbens (2008)).4
In this article, we derive large sample approximations to the distribution of propensity score matching estimators. Our derivations take into account that the propensity score is itself estimated in a first step. We show that propensity matching estimators have approximately Normal distributions in large samples. We demonstrate that first step estimation of the propensity score affects the large sample distribution of propensity score matching estimators, and derive adjustments to the large sample variance of propensity score matching estimators that correct for first step estimation of the propensity score. We do this for estimators of the average treatment effect (ATE) and the average treatment effect on the treated (ATET). The adjustment for the ATE estimator is negative (or zero in some special cases), implying that matching on the estimated propensity score is more efficient than matching on the true propensity score in large samples. As a result, treating the estimated propensity score as it was the true propensity score for estimating the variance of the ATE estimator leads to conservative confidence intervals. However, for the ATET estimator, the sign of the adjustment depends on the data generating process, and ignoring the estimation error in the propensity score may lead to confidence intervals that are either too large or too small.

2. MATCHING ESTIMATORS
The setup in this article is a standard one in the program evaluation literature, where the focus of the analysis is often the effect of a binary treatment,

3Influential papers using matching on the estimated propensity score include Heckman, Ichimura, and Todd (1997), Dehejia and Wahba (1999), and Smith and Todd (2005).
4In contexts other than matching, Heckman, Ichimura, and Todd (1998), Hirano, Imbens, and Ridder (2003), Abadie (2005), Wooldridge (2007), and Angrist and Kuersteiner (2011) derived large sample properties of statistics based on a first step estimator of the propensity score. In all these cases, the second step statistics are smooth functionals of the propensity scores and, therefore, standard stochastic expansions for two-step estimators apply (see, e.g., Newey and McFadden (1994)).

MATCHING ON THE ESTIMATED PROPENSITY SCORE

783

represented in this paper by the indicator variable W , on some outcome variable, Y . More specifically, W = 1 indicates exposure to the treatment, while W = 0 indicates lack of exposure to the treatment. Following Rubin (1974), we define treatment effects in terms of potential outcomes. We define Y (1) as the potential outcome under exposure to treatment, and Y (0) as the potential outcome under no exposure to treatment. Our goal is to estimate the average treatment effect,

 = E Y (1) - Y (0)

where the expectation is taken over the population of interest. Alternatively, the goal may be estimation of the average effect for the treated,

t = E Y (1) - Y (0)|W = 1
Estimation of these average treatment effects is complicated by the fact that for each unit in the population, we observe at most one of the potential outcomes:

Y=

Y (0) Y (1)

if W = 0, if W = 1.

Let X be a vector of covariates of dimension k. The propensity score is p(X) = Pr(W = 1|X), and p = Pr(W = 1) is the probability of being treated. The following assumption is often referred to as "strong ignorability" (Rosenbaum and Rubin (1983)). It means that adjusting for X is sufficient to eliminate all confounding.

ASSUMPTION 1: (i) Y (1) Y (0)  W |X almost surely; (ii) p  p(X)  p almost surely, for some p > 0 and p < 1.

Assumption 1(i) uses the conditional independence notation in Dawid (1979). This assumption is often referred to as "unconfoundedness." It will hold, for example, if all confounders are included in X, so that after controlling for X, treatment exposure is independent of the potential outcomes. Hahn (1998) derived asymptotic variance bounds and studied asymptotically efficient estimation under Assumption 1(i). Assumption 1(ii) implies that, for almost all values of X, the population includes treated and untreated units. Moreover, Assumption 1(ii) bounds the values of the propensity score away from zero and 1. Khan and Tamer (2010) have shown that this condition is necessary for root-N consistent estimation of the average treatment effect.
Let (w x) = E[Y |W = w X = x] and 2(w x) = var(Y |W = w X = x) be the conditional mean and variance of Y given W = w and X = x. Similarly, let ¯ (w p) = E[Y |W = w p(X) = p] and ¯ 2(w p) = var(Y |W = w p(X) = p) be the conditional mean and variance of Y given W = w and

784

A. ABADIE AND G. W. IMBENS

p(X) = p. Under Assumption 1,

 = E (1 X) - (0 X)

and

t = E (1 X) - (0 X)|W = 1

(see Rubin (1974)). Therefore, adjusting for differences in the distribution of X between treated and nontreated removes all confounding and, therefore, allows identification of ATE and ATET. Rosenbaum and Rubin (1983) proved that W and X are independent conditional on the propensity score, p(X), which implies that under Assumption 1:

 = E ¯ 1 p(X) - ¯ 0 p(X)

and

t = E ¯ 1 p(X) - ¯ 0 p(X) |W = 1
In other words, under Assumption 1, adjusting for the propensity score only is enough to remove all confounding. This result motivates the use of propensity score matching estimators. A propensity score matching estimator for the average treatment effect can be defined as

N

=

1 N

N
(2Wi - 1)

Yi

-

1 M

Yj

i=1

jJM (i)

where M is a fixed number of matches per unit and JM(i) is the set of matches for unit i.5 (The superscript  on N indicates that matching is done on the true propensity score.) For concreteness, in this article we will consider matching
with replacement, so each unit in the sample can be used as a match multiple
times. In the absence of matching ties, the set of matches JM(i) can formally

5In typical applications, M is small, often M = 1. Choosing a small M reduces finite sample biases caused by matches of poor quality, that is, matches between individuals with substantial differences in their propensity score values. Larger values of M produce lower large sample variances (see Abadie and Imbens (2006, Section 3.4)), and one could consider increasing M in a particular application if such increase has a small effect on the size of the matching discrepancies, which are observed in the data (Abadie and Imbens (2011)). Similarly to Yatchew's (1997) work on semiparametric differencing estimators, we derive a large sample approximation to the distribution of matching estimators for fixed values of M. Large sample approximations based on fixed values of smoothing parameters have been shown to increase accuracy in other contexts (see, in particular, Kiefer and Vogelsang (2005)).

MATCHING ON THE ESTIMATED PROPENSITY SCORE

785

be defined as

JM (i) = j = 1 N : Wj = 1 - Wi

1[|p(Xi)-p(Xk)||p(Xi)-p(Xj )|]
k:Wk =1-Wi

M

where 1[·] is a binary indicator that takes value 1 if the event inside brackets is true, and value zero if not. For the average effect on the treated, t, the corresponding estimator is

t N

=

1 N1

N i=1

Wi

1

Yi - M

Yj

jJM (i)

where N1 =

N i=1

Wi

is

the

number

of

treated

units

in

the

sample.

The large sample distributions of N and t N can be easily derived from re-

sults on matching estimators in Abadie and Imbens (2006), applied to the case

where the only matching variable is the known propensity score. However, one

of the assumptions in Abadie and Imbens (2006) requires that the density of

the matching variables is bounded away from zero. Although this assumption

may be appropriate in settings where the matching is carried out directly on

the covariates, X, it is much less appealing for propensity score matching es-

timators. For example, if the propensity score has the form p(X) = F(X ),

then even if the density of X is bounded away from zero on its support, the

density of F(X ) will generally not be bounded away from zero on its sup-

port. We therefore generalize the results in Abadie and Imbens (2006) to al-

low the density of propensity score to take values that are arbitrarily close to

zero.

ASSUMPTION 2: (i) The propensity score p(X) is continuously distributed, has interval support [p p], and has a density that is a continuous function on [p p];
(ii) for w = 0 1, ¯ (w p) and ¯ 2(w p) are Lipschitz-continuous and continuous in p, respectively; (iii) for w = 0 1, there exists  > 0 such that E[|Y |2+|W = w p(X) = p] is uniformly bounded.

ASSUMPTION 3: {(Yi Wi Xi)}iN=1 are independent draws from the distribution of (Y W X).

The next proposition presents the large sample distributions of N and t N under Assumptions 1­3.

PROPOSITION 1: Suppose Assumptions 1­3 hold. Then, (i)

 N

N - 

d N

0

2

786

A. ABADIE AND G. W. IMBENS

where

2 = E ¯ 1 p(X) - ¯ 0 p(X) -  2

+ E ¯ 2 1 p(X)

1 +1

1 - p(X)

p(X) 2M p(X)

+ E ¯ 2 0 p(X)

×

1

-

1 p(X )

+

1 2M

1

-

1 p(X )

-

1 - p(X)

and (ii)

 N t N - t

d N 0 t2

where

t2 = E

1 p(X )

2E

p(X )

¯

1

p(X )

- ¯

0

p(X )

- t

2

+

E

1 p(X )

2E

¯ 2

1

p(X )

p(X )

+ E

1 p(X) 2 E

¯ 2

0

p(X )

× p2(X) + 1 p(X) + 1 p2(X)

1 - p(X) M

2M 1 - p(X)

The proof of this proposition is available in the Supplemental Material (Abadie and Imbens (2016)).
Motivated by the fact that, in observational studies, propensity scores are not known, we are interested in the case where matching is not on the true propensity score p(X), but on an estimate of the propensity score. Following Rosenbaum and Rubin (1983) and most of the empirical literature, we consider a generalized linear specification for the propensity score, p(x) = F(x ). In empirical research, the link function F is usually specified as Logit or Probit. It is straightforward to extend our results to more general parametric models for the propensity score.6 For unit i, and for arbitrary values for , let JM(i )

6Misspecification of the propensity score typically leads to inconsistency of the treatment effect estimator, unless the misspecified propensity score constitutes a balancing score, that is, a function, b(X), of the covariates such that X  W |b(X) (see Rosenbaum and Rubin (1983)). Moti-

MATCHING ON THE ESTIMATED PROPENSITY SCORE

787

denote the set of M matches where we match on F(X ):

JM (i ) = j = 1 N : Wj = 1 - Wi

1[|F(Xi )-F(Xk)||F(Xi )-F(Xj )|]
k:Wk =1-Wi

M

The matching estimator for the average treatment effect where we match on F(X ) is then

1N

1

N () = N (2Wi - 1) Yi - M

Yj

i=1

jJM (i )

Let  denote the true value of the propensity score model parameter vec-
tor, so that p(X) = F(X ). Then, the estimator based on matching on the true propensity score can be written as N = N(). We are interested in the case where N() is evaluated at an estimator N of , based on a sample {Yi Wi Xi}Ni=1. We focus on the case where N is the maximum likelihood esti-
mator of :7

N = arg max L(|W1 X1 
where the log-likelihood function is

WN XN )

L(|W1 X1

WN XN )

N
= Wi ln F Xi + (1 - Wi) ln 1 - F Xi
i=1

The propensity score matching estimator of  that matches on the estimated propensity score can now be written as

1N

1

N = N (N ) = N (2Wi - 1) Yi - M

Yj

i=1

jJM (i N )

vated by this consideration, empirical researchers routinely use measures of balance in the distribution of the covariates between treated and nontreated, conditional on the estimated propensity score, to perform specification searches on the propensity score (see, e.g., Dehejia and Wahba (1999)). An alternative safeguard against misspecification of the propensity score is the use "doubly robust" matching estimators, like the bias-corrected matching estimator of Abadie and Imbens (2011).
7It is straightforward to extend our results to other asymptotically linear estimators of .

788

A. ABADIE AND G. W. IMBENS

Similarly, the propensity score matching estimator of t that matches on the estimated propensity score can be written as

t

N

=

t

N (N )

=

1 N1

N
Wi
i=1

1

Yi - M

Yj

jJM (i N )

Whenever confusion is possible, we will be explicit in the dependence of the matching estimators on . If the argument is omitted, N and t N are used as shorthand for N (N ) and t N (N ), respectively.
The two main questions addressed in this article are (i) do the estimators based on matching on the estimated propensity score have Normal large sample distributions, and (ii) if so, how does their large sample variance compare to that of the estimators that match on the true propensity score, given in Proposition 1? In the next section, we answer these two questions and derive the large sample distribution of N (N ) and t N(N ). Conventional linearization methods for two-step statistics are difficult to apply in the context of matching estimators because matching estimators are complicated functionals of the distribution of the data. We therefore follow a different route, building on work by Andreou and Werker (2012) on residual based statistics, and the martingale representations for matching estimators derived in Abadie and Imbens (2012).

3. LARGE SAMPLE DISTRIBUTION
In the first part of this section, we derive the large sample approximation to the sampling distribution of N(N), and in the second part, we present the results for t N (N ).
Let P be the distribution of Z = {Y W X} induced by the propensity score, F(X ), the marginal distribution of X, and the conditional distribution of Y given X and W . We index this distribution P by , and will consider properties of estimators for different values of , under the same marginal distribution for X, and the same conditional distribution for Y given W and X. Given Assumption 1, the average treatment effect is equal to

 = E Y (1) - Y (0) = E E[Y |W = 1 X] - E[Y |W = 0 X]

From this equation, it can be seen that ATE does not depend on the propensity score; it only depends on the conditional distribution of Y given W and X and the marginal distribution of X. The average treatment effect for the treated is

t = E Y (1) - Y (0)|W = 1

= E E[Y |W = 1 X] - E[Y |W = 0 X]|W = 1

E F X  E[Y |W = 1 X] - E[Y |W = 0 X]

=

E F X 

MATCHING ON THE ESTIMATED PROPENSITY SCORE

789

In contrast to the average treatment effect, , the average treatment effect for
the treated, t, depends on the propensity score, and we make this dependence explicit by indexing t by  wherever appropriate. In particular, t = t() is the average effect of the treatment on the treated.
To derive the large sample distribution of N and t N , we invoke some additional regularity conditions. First, we extend Assumption 2 to hold for all  in a neighborhood of .

ASSUMPTION 4: (i)   int() with  compact, X has a bounded support, and E[XX ] is nonsingular; (ii) F : R  (0 1) is continuously differentiable with
strictly positive and bounded derivative f ; (iii) there exists a component of X that is continuously distributed, has nonzero coefficient in , and admits a continuous
density function conditional on the rest of X; and (iv) there exists  > 0 such that, for all  with  -   , E[Y |W = w F(X ) = p] is Lipschitz-continuous in p, var(Y |W = w F(X ) = p) is continuous in p, and there is  > 0 such that E[|Y |2+|W = w F(X ) = p] is uniformly bounded.

The case of only discrete regressors is left out from Assumption 4, but, as noted in Abadie and Imbens (2006), it is a simple case to treat separately. With only discrete regressors, each observation (or each treated observation in the case of ATET) can be matched to every observation with identical estimated propensity score value in the opposite treatment arm. In this case, the propensity score matching estimator is identical to the subclassification estimator in Cochran (1968) and Angrist (1998), and valid analytical and bootstrap standard errors can be easily derived.
We will study the behavior of certain statistics under sequences N that are local to . Consider ZN i = {YN iWN i XN i} with distribution given by the local "shift" PN with N =  + h/ N, where h is a conformable vector of constants. Let N(| ) be the difference between the value of the log-likelihood function evaluated at  and the value of the log-likelihood function evaluated at  :

N | = L(|ZN 1

ZN N ) - L  |ZN 1

ZN N

Let N() be the normalized score function, or central sequence,

N ()

=

1 N

 

L(|ZN

1

ZN N )

= 1 N

N
i=1 XN i F

WN i - F XN i XN i 1 - F XN i

f XN i

790

A. ABADIE AND G. W. IMBENS

Finally, let

f X 2 I = E F X  1 - F X  XX

be the Fisher Information Matrix for . The expectation in this equation is taken over the marginal distribution of X, which does not depend on , so the indexing by  solely reflects the value of  where f (X ) and F(X ) are evaluated. The following intermediate lemma derives some important regularity properties of the propensity score model that will be needed for our derivations.

LEMMA 1: Suppose that Assumptions 3, 4(i), and 4(ii) hold. Then, under PN ,

(1)

N |N

1 = -h N (N ) - 2 h I h + op(1)

(2)

N (N ) d N(0 I )

where I is not singular, and



(3)

N(N - N ) = I-1N (N ) + op(1)

The proof of this proposition is available in the Supplemental Material (Abadie and Imbens (2016)). For regular parametric models, equation (1) can be established using Proposition 2.1.2 in Bickel, Klaassen, Ritov, and Wellner (1998). Also for regular parametric models, equation (2) is derived in the proof of Proposition 2.1.2 in Bickel et al. (1998). Equation (3) can be established using the same set of results in combination with classical conditions for asymptotic linearity of maximum likelihood estimators (see, e.g., van der Vaart (1998, Theorem 5.39), Lehmann and Romano (2005, Theorem 12.4.1)).
Let E be the expectation operator with respect to the distributions P. The following assumption is a regularity condition that will be used later in this section.

ASSUMPTION 5: EN [r(Y W X)|W F(X N )] converges to E[r(Y W X)| W F(X )] almost surely, for any Rk+2-to-R bounded and measurable function, r(y w x), continuous in x, and any sequence, N  .

Primitive conditions for this assumption are provided in the Supplemental Material.

MATCHING ON THE ESTIMATED PROPENSITY SCORE

791

3.1. Large Sample Distribution for N(N) 
Our derivation of the limit distribution of N(N - ) is based on the techniques developed in Andreou and Werker (2012) to analyze the limit distribu-
tion of residual-based statistics. We proceed inthree steps. First, we derive the joint limit distribution of ( N(N (N ) - ) N( - N ) N(|N )) under PN .

PROPOSITION 2: Suppose that Assumptions 1­5 hold. Then, under PN ,

 

 N N (N ) - N(N - N

 )

 

N |N 

0

d N 

0

-h I h/2

 2  I-1c
-h c

c I-1 I-1 -h

-c h  -h 
h I h

where

cov X (1 X)|F X 

(4)

c=E

F X 

cov X (0 X)|F X 

+

1 - F X 

f X 

All proofs for the results in this section are provided in the Appendix. Asymptotic Normality of the first component, N(N(N) - ), under

P 

follows from Proposition 1. Asymptotic joint Normality of the last two components, N(N - N ) and N(|N ), follows from Lemma 1. Proposition 2 derives the joint large sample distribution of the three components under PN .

The proof extends the martingale techniques of Abadie and Imbens (2012) to

derive the result of the proposition.

In the second step of our argument, we use Le Cam's third lemma (e.g.,

van der Vaart (1998, p. 90)). Given the result of Proposition 2, Le Cam's third lemma implies that, under P ,



N 

N (N ) - 

N(N - N )

d N

-c h -h

2 I-1c

c I-1 I-1

Substituting

N

=



+

 h/ N,

this

implies

that

(still

under

P ),

for

any

h



Rk,





(5)

N N  + h/ N -  N N - 

d N

-c h 0

2 I-1c

c I-1 I-1

792

A. ABADIE AND G. W. IMBENS

If equation (5) was an exact result rather than an approximation based on convergence in distribution, it would directly lead to the result of interest. In that case, it would follow that







N N  + h/ N -  | N N - 

= h  N 0  2 - c I-1c

 (see, e.g., Goldberger (1991, p. 197)). Because N(N - ) = h implies  + h/ N = N , and thus implies that N ( + h/ N) = N (N ) = N , the last displayed equation can also be written as





N(N - )| N(N - ) = h  N 0 2 - c I-1c

Because this conditional distribution does not depend on h, this in turn implies that, under P , unconditionally,
 N(N - )  N 0 2 - c I-1c

which is the result we are looking for: the distribution of the matching estima-

tor based on matching on the estimated propensity score.



 A challenge formalizing this argument is that convergence of N(N - )|

N(N - ) = h involves convergence in a conditioning event. To overcome

this challenge, in the third step of the argument, we employ a Le Cam dis-

cretization device, as proposed in Andreou and Werker (2012). Consider a grid of cubes in Rk with sides of length d/ N, for arbitrary positive d. Then

¯N is the discretized estimator, defined as the midpoint of the cube N belongs

to. If N j is the the k-vector ¯N

jisth¯cNojm=po(dn/entNo)f [theNk-Nvej /cdto]r,

N , then where [·]

the jth component of is the nearest integer

function. Now we can state the main result of the paper.

THEOREM 1: Suppose Assumptions 1­5 hold. Then, under P ,

 lim lim Pr N
d0 N

 2 - c I-1c -1/2 N (¯N ) - 

z

= z 1 exp - 1 x2 dx

- 2

2

An implication of Theorem 1 is that we can approximate the distribution of N(N(N) - ) by a Normal distribution with mean zero and variance 2 - c I-1c. The result in Theorem 1 indicates that the adjustment to the stan-

MATCHING ON THE ESTIMATED PROPENSITY SCORE

793

dard error of the propensity score matching estimator for first step estimation of the propensity score is always negative, or zero in some special cases as discussed below. This implies that using matching on the estimated propensity score, rather than on the true propensity score, to estimate ATE increases precision in large samples. As we will see later, this gain in precision from using the estimated propensity score does not necessarily hold for the estimation of parameters different than ATE.
Equation (4) and the fact that X and W are independent conditional on the propensity score imply that if the covariance of X and (W X) given F(X ) and W is equal to zero, then c = 0 and first step estimation of the propensity score does not affect the large sample variance of N(N - ). This would be the case if the propensity score provides no "dimension reduction," that is, if the propensity score is a bijective function of X. In that case, each value of the propensity score corresponds to only one value of X, so cov(X (W X)|W F(X )) = 0 and, therefore, c = 0.
For concreteness, our derivations focus on the case of matching with replacement. However, as shown in Abadie and Imbens (2012), martingale representations analogous to the one employed in the proof of Proposition 2 exist for alternative matching estimators (e.g., estimators that construct the matches without using replacement). An inspection of the proof of Proposition 2 reveals that the adjustment term, -c Ic, does not depend on the type of matching employed to obtain the estimators. Therefore, the result in Theorem 1 translates easily to other matching settings. A different type of matching scheme may change the form of 2 in the result of Theorem 1, but not the adjustment term, -c I c.

3.2. Large Sample Distribution for t N 
In this section, we consider the asymptotic distribution for N(t N - t()). The derivations are similar to those for the case of ATE, so we rel-
egate details to the Supplemental Material. The following theorem provides
the result.

THEOREM 2: Suppose Assumptions 1­5 hold, and let

ct =

E

F

1 X 

E Xf X 

¯ 1 F X 

- ¯ 0 F X 

- t

+

E

F

1 X



E

cov X (1 X)|F X 

F X  + 1 - F X 

cov X

(0 X)|F X 

f X 

794

A. ABADIE AND G. W. IMBENS

Then, under P ,

lim lim Pr
d0 N

 N

t2

-

ct I-1ct

+

t  

I-1

t  

-1/2

× t N (¯N ) - t  z

=

z1 

exp - 1 x2 dx

- 2

2

Notice that, in contrast to the ATE case, the adjustment for first step estimation of the propensity score for the ATET estimator may result in a decrease or an increase in the standard error. The adjustment to the standard error of the ATET estimator will be positive, for example, if the propensity score does not provide "dimension reduction," so ct = 0, and t()/ = 0 (which will typically be the case if the average effect of the treatment varies with the covariates, X). In contrast, if ct = 0 and t()/ = 0, the adjustment is negative. Like for the case of ATE, it can be shown that the adjustment term does not depend on the particular type of matching estimator of ATET.

4. ESTIMATION OF THE ASYMPTOTIC VARIANCE

In this section, we discuss estimation of the large sample variances of ATE and ATET adjusting for first step estimation of the propensity score. As shown in the previous section, the asymptotic variance for N(N - ) is

(6)

a2dj =  2 - c I-1c

 and the asymptotic variance for N(t N - t) is

(7)

t2 adj

=

t2

-

ct I-1ct

+

t  

I-1

t  

To estimate a2dj and t2adj, we define estimators of each of the components of the right-hand sides of equations (6) and (7). First, estimation of the information matrix, I , is standard:

I

=

1 N

N i=1

F

f Xi N

Xi N 2 1 - F XiN

XiXi

Consider next estimation of the variances corresponding to matching on the true propensity score, 2 and t2. For these components, we use estimators

MATCHING ON THE ESTIMATED PROPENSITY SCORE

795

that are based on those in Abadie and Imbens (2006). Let KM (i) be the number of times that observation i is used as a match (when matching on F(X )):

N

(8)

KM (i) =

1[iJM (j )]

j=1

and let ¯ 2(Wi F(Xi)) be an asymptotically unbiased (but not necessarily consistent) estimator of ¯ 2(Wi F(Xi)). The Abadie and Imbens (2006) variance estimators are

2 = 1 N N

(2Wi - 1)

Yi

-

1 M

2
Yj - N

i=1

jJM (i )

+1 N N
i=1

KM (i) 2 + 2M - 1 KM (i)

M

M

M

¯ 2 Wi F Xi 

and

t2

=

N N12

N
Wi
i=1

1

Yi - M

Yj - t N

jJM (i )

2

+

N N12

N
(1 - Wi)
i=1

KM (i) KM (i) - 1 M2

¯ 2 Wi F Xi 

To obtain the estimator ¯ 2(Wi F(Xi)), let HL(i ) be the set of units in the same treatment arm as unit i that have the closest L values of F(X ) to
F (Xi ),

HL(i ) = j = 1 N : Wj = Wi

1[|F(Xi )-F(Xk)||F(Xi )-F(Xj )|]
k:Wk =Wi

L

where L is generic notation for a (small) positive integer. Later, we will also

use

the

set

H(-i) L

(i

), which is

similarly defined

but excludes i:

H(-i) L

(i

) =

j=1

N : i = j Wj = Wi

1[|F(Xi )-F(Xk)||F(Xi )-F(Xj )|]
k:Wk=Wi k=i

L

796

A. ABADIE AND G. W. IMBENS

The sets HL(i ), HL(-i)(i ), and JL(i ) (this last one defined in Section 2) will be used to estimate the different components of a2dj and t2adj. The value of L can vary for different components.
For L  2 (typically, L = 2), consider the following matching estimator of ¯ 2(Wi F (Xi)):

¯ 2 Wi F Xi 

1

1

2

= L-1

Yj - L

Yk

jHL(i N )

kHL(i N )

That is, ¯ 2(Wi F(Xi)) is a local variance estimator that uses information only from units with the same value of W as unit i and with similar values of
F(X N ). Because N -  converges in probability to zero, ¯ 2(Wi F(Xi)) becomes asymptotically unbiased as N  . But because L is fixed, the variance of ¯ 2(Wi F(Xi)) does not converge to zero and ¯ 2(Wi F(Xi)) is not consistent for ¯ 2(Wi F(Xi)). The objects of interest, however, are 2 and t2, rather than ¯ 2(Wi F(Xi)). The estimators 2 and t2 average terms that are bounded in probability and asymptotically unbiased. As a result, as shown
in Abadie and Imbens (2006), 2 and t2 are consistent for 2 and t2, respectively.
Next consider estimation of c and ct. Notice first that

cov X Y |F X  W = 1

= cov X (1 X)|F X  W = 1

+ cov X Y - (1 X)|F X  W = 1

= cov X (1 X)|F X 

+ cov X Y - (1 X)|F X  W = 1

Using the Law of Iterated Expectations, cov X Y - (1 X)|F X  W = 1 = E X Y - (1 X) |F X  W = 1 - E X|F X  W = 1 × E Y - (1 X)|F X  W = 1 = E X (1 X) - (1 X) |F X  W = 1 - E X|F X  W = 1 × E (1 X) - (1 X)|F X  W = 1 =0

MATCHING ON THE ESTIMATED PROPENSITY SCORE

797

Therefore, cov X (1 X)|F X  = cov X Y |F X  W = 1

and the analogous result is valid conditional on Wi = 0: cov X (0 X)|F X  = cov X Y |F X  W = 0

If Wi = w, cov(Xi (w Xi)|F(Xi)) can be estimated as cov Xi (w Xi)|F Xi

=1 L-1

1

Xj - L

Xk

jHL(i N )

kHL(i N )

1

Yj - L

Yk

kHL(i N )

for L  2 (typically, L = 2). If Wi = w, then cov Xi (w Xi)|F Xi

1

1

= L-1

Xj - L

Xk

jJL(i N )

kJL(i N )

1

Yj - L

Yk

kJL(i N )

also for L  2 (typically, L = 2). Like ¯ 2(Wi F(Xi)), the estimators cov(Xi (w Xi)|F(Xi)) are asymptotically unbiased and bounded in probability. This allows us to construct a consistent analog estimator of c that averages cov(Xi (w Xi)|F(Xi)) over the sample:

c = 1 N cov Xi (1 Xi)|F Xi

N i=1

F Xi N

cov +

Xi

(0

Xi)|F

Xi 

1 - F XiN

f Xi N

For ct, we propose separate estimators for the two components, ct 1 and ct 2, where

ct 1 = E

F

1 X 

E Xf X 

× ¯ 1 F X  - ¯ 0 F X  - t

ct 2 = E

F

1 X 

E

cov X (1 X)|F X 

F X  + 1 - F X 

cov X

(0 X)|F X 

f X 

798

A. ABADIE AND G. W. IMBENS

and ct = ct 1 + ct 2. The second component, ct 2, is similar to ct , and our proposed estimator for ct 2 is correspondingly similar to the estimator for c:

(9)

ct

2

=

1 N1

N i=1

cov Xi (1 Xi)|F Xi

+ F XiN 1 - F XiN

cov Xi

(0

Xi)|F

Xi 

f Xi N

The first component, ct 1, involves the regression functions ¯ (w F(X )). We estimate these regression functions using matching:

¯ 0 F Xi

=

  

1 L
1 L

j H(L-i) (i

Yj
N )
Yj

jJL(i N )

if Wi = 0, if Wi = 1,

and

¯ 1 F Xi

 

1 L

Yj

=



1 L

j JL (i

N )

Yj

jH(L-i)(i N )

if Wi = 0, if Wi = 1,

for L  1 (typically, L = 1). Our proposed estimator for ct 1 is

1N

ct 1 = N1

Xif
i=1

Xi N

¯ 1 F Xi

- ¯ 0 F Xi

- t

Notice that if Wi = w, the estimator of ¯ (w F(Xi)) is an average over

H(-i) L

(i

N ),

rather

than

over

HL(i

N ).

If

observation

i

was

not

excluded

to estimate ¯ (Wi F(Xi)), then Yi would be one of the terms of the aver-

age ¯ (Wi F(Xi)). Therefore, if observation i was not excluded, the estima-

tor ct 1 would contain terms of the type Xif (XiN )(Yi - ¯ (0 F(Xi)) - t)

when Wi = 1 and terms of the type Xif (XiN )(¯ (1 F(Xi)) - Yi - t) when Wi = 0. These terms estimate E[Xf (X )((1 X) - ¯ (0 F(X )) - t)]

and E[Xf (X )(¯ (1 F(X )) - (0 X) - t)], respectively, rather than

E[Xf (X )(¯ (1 F(X )) - ¯ (0 F(X )) - t)]. To avoid this problem, we

exclude observation i for the estimation of ¯ (Wi F(Xi)).

MATCHING ON THE ESTIMATED PROPENSITY SCORE

799

For the remaining variance component, t()/, notice that

t 



=

E

F

1 X



E Xf X 

Y (1) - Y (0) - t

1 = E F X 

E Xf X 

(1 X) - (0 X) - t

To estimate this component, we need to estimate the regression functions (1 X) and (0 X), which is done by matching on the covariates rather than on the propensity score. Define the matching set (on covariates):

JLX(i) = j = 1

N : Wj = 1 - Wi

1[ Xi-Xk  Xi-Xj ]
k:Wk =1-Wi

L

Our estimator of t()/ is

t 

1 =
N1

N
Xif
i=1

Xi N

1

(2Wi - 1) Yi - L

Yj

jJLX (i)

- t

Putting these results together, our estimator of the large sample variance of the propensity score matching estimator of the average treatment effect, adjusted for first step estimation of the propensity score, is

a2dj =  2 - c I-1c
The corresponding estimator for the variance for the estimator for the average effect for the treated is

a2dj t

= t2 - ct I-1ct

+

t 

I-1

t 

Consistency of these estimators for fixed L can be shown using the results in Abadie and Imbens (2006) and the arguments employed in Section 3.

5. CONCLUSIONS AND EXTENSIONS
In this article, we derive the large sample distribution of propensity score matching estimators for the case where the propensity score is unknown and needs to be estimated in a first step prior to matching. We show that first step estimation of the propensity score generally affects the asymptotic variance of matching estimators, and derive adjustments for propensity score matching

800

A. ABADIE AND G. W. IMBENS

estimators of ATE and ATET. These results allow, for the first time, valid large sample inference for estimators that use matching on the estimated propensity score.
For concreteness, we frame the article within the context of estimation of average treatment effects under the assumption that treatment assignment is independent of potential outcomes conditional on a set of covariates, X (Assumption 1(i)). Without this assumption, the results of this article apply still to the estimation of the "controlled comparison" parameters

E E[Y |X W = 1] - E[Y |X W = 0]

and

E[Y |W = 1] - E E[Y |X W = 0]|W = 1

which have the same form as ATE and ATET parameters but lack a causal interpretation in the absence of Assumption 1(i). Controlled contrasts are the building blocks of Oaxaca­Blinder-type decompositions, commonly applied in economics (Oaxaca (1973), Blinder (1973), DiNardo, Fortin, and Lemieux (1996)). The ideas and results in this article can easily be applied to other contexts where it is required to adjust for differences in the distribution of covariates between two samples. An important example is estimation with missing data when missingness is random conditional on a set of covariates (see, e.g., Little and Rubin (2002), Wooldridge (2007)).

APPENDIX
Before proving Proposition 2, we introduce some additional notation. Using the definition of KM (i) in (8), the estimator N() can be written as

N

()

=

1 N

N
(2Wi - 1)

1 + KM (i) M

Yi

i=1

Define ¯ (w p) = E[Y |W = w F(X ) = p], where E is the expectation operator under P,

1N

DN () =  N

i=1

¯ 

1

F

Xi 

- ¯  0 F Xi

-

+ 1 N

N
(2Wi - 1)
i=1

1 + KM (i) M

Yi - ¯  Wi F Xi

MATCHING ON THE ESTIMATED PROPENSITY SCORE

801

and

1N

RN () = 

(2Wi - 1)

N i=1

× ¯  1 - Wi F Xi

1

- M

¯  1 - Wi F Xj

jJM (i)

Now the normalized estimator can be written as  N N () -  = DN () + RN ()

PROOF OF PROPOSITION 2: It can be seen that the result of Lemma S.1 in
the Supplemental Material (Abadie and Imbens (2016)) holds uniformly in  for  -   . This implies RN (N ) p 0. Therefore, in order to prove the result in the proposition, it suffices to prove that, under PN ,

 

 DN (N ) N(N - N

)

 

N |N 

0

d N 

0

-h I h/2

 2  I-1c
-h c

c I-1 I-1 -h

-c h  -h 
h I h

By Lemma 1, under PN ,

N |N

1

=

-h

N (N )

-

h 2

I h

+

op(1)

and  N(N - N ) = I-1N (N ) + op(1)

Therefore, it suffices to prove that, under PN ,

(A.1)

DN (N ) N (N )

d N

0 0

2 c c I

To prove (A.1), we extend the martingale representation of matching estimators (Abadie and Imbens (2012)) to allow for estimation of the propensity

802

A. ABADIE AND G. W. IMBENS

score. Consider the linear combination CN = z1DN (N ) + z2N (N ):

1N

CN = z1  N

i=1

¯ N

1

F

XN iN

- ¯ N 0 F XN iN

-

+ z1 1 N

N
(2WN i - 1)
i=1

1 + KM N (i) M

× YN i - ¯ N WN i F XN iN

1

+

z2

 N

N i=1

XN i F

WN i - F XN iN XN iN 1 - F XN iN

f XN iN

We analyze CN using martingale methods. First, notice that

3N
CN = N k
k=1
where

N k = z1 1 N

¯ N

1

F

XN kN

- ¯ N 0 F XN kN

-

+

z2

1 N

E

XN k|F

XN kN

×

WN k - F XN kN

F XN kN 1 - F XN kN

f XN kN

for 1  k  N,

N

k

=

z2

1 N

XN k-N - E XN k-N |F

XN k-N N

× WN k-N - F XN k-N N f XN k-N N F XN k-N N 1 - F XN k-N N

+ z1 1 (2WN k-N - 1) N

1 + KM N (k - N) M

× (WN k-N XN k-N ) - ¯ N WN k-N F XN k-N N

MATCHING ON THE ESTIMATED PROPENSITY SCORE

803

for N + 1  k  2N, and

N k = z1 1 (2WN k-2N - 1) N

1 + KM N (k - 2N) M

× YN k-2N - (WN k-2N XN k-2N )

for 2N + 1  k  3N. Consider the -fields FN k = {WN 1

WN k XN 1N

XN kN } for 1  k  N, FN k = {WN 1

WN N XN 1N

XN N N

XN 1

XN k-N } for N + 1  k  2N, and FN k = {WN 1

WN N

XN 1

XN N YN 1

YN k-N } for 2N + 1  k  3N. Then,

i
N j FN i 1  i  3N
j=1

is a martingale for each N  1. Therefore, the limiting distribution of CN can be studied using a Martingale Central Limit Theorem (e.g., Theorem 35.12 in Billingsley (1995, p. 476); importantly, notice that this theorem allows that the probability space varies with N). Because of Assumption 4, and because KM (i) has uniformly bounded moments (see Abadie and Imbens (2016)), it follows that

3N
EN |N k|2+  0 for some  > 0
k=1

Lindeberg's condition in Billingsley's theorem follows easily from the last equation (Lyapunov's condition). As a result, we obtain that, under PN ,

CN d N 0 12 + 22 + 32

where

N
12 = plim EN N2 k|FN k-1
k=1

2N

22 = plim

EN N2 k|FN k-1

k=N +1

3N

32 = plim

EN N2 k|FN k-1

k=2N +1

804

A. ABADIE AND G. W. IMBENS

Assumption 5 implies

12 = z12E ¯ 1 F X  - ¯ 0 F X  f 2 X 
+ z2E F X  1 - F X 

- 2

× E X|F X  E X |F X  z2

Expectations of the sums of terms involving (1 + KM N (i)/M)2 can be calculated as in Abadie and Imbens (2016). We obtain

22 = z2E

f 2 X  F X  1 - F X 

var X|F X 

z2

+ z12E

var (1 X)|F X  F X 

var (0 X)|F X 

+

1 - F X 

+

z12

1 2M

E

1 F X 

- F X 

var (1 X)|F X 

+

z12

1 2M

E

1 1 - F X 

-

1 - F X 

× var (0 X)|F X 

cov X (1 X)|F X 

+ 2z2E

F X 

cov X (0 X)|F X 

+

1 - F X 

f X  z1

Here we use the fact that, conditional on the propensity score, X is independent of W . Finally, notice that

1 N 1 + KM N (i) 2

N

M

i=1

× var(Yi|Wi Xi) - E var(Yi|Wi Xi)|Wi F XiN

MATCHING ON THE ESTIMATED PROPENSITY SCORE

805

is a sum of martingale differences

1 N i = N

1 + KM N (i) M

2

× var(Yi|Wi Xi) - E var(Yi|Wi Xi)|Wi F XiN

with respect to the filtration FN i = {W1

WN X1N

X1N

X1

Xi}. As a result, we obtain that, for i > j, E[N iN j|FN i-1] =

E[N i|FN i-1]N j = 0. Therefore, using the Law of Iterated Expectations to

eliminate the cross-products, we obtain

E

1N

N

N i

i=1

2

=

1 N2

E

N
N2 i
i=1

0

Therefore,

32

=

z12

plim

1 N

N

1 + KM N (i) M

2
E var(Yi|Wi Xi)|Wi F XiN

i=1

= z12E

E var(Y |X W = 1)|F X  F X 

E var(Y |X W = 0)|F X 

+

1 - F X 

+

z12

1 2M

E

1 F X 

- F X 

× E var(Y |X W = 1)|F X 

+

z12

1 2M

E

1 1 - F X 

-

1 - F X 

× E var(Y |X W = 0)|F X 

Collecting terms and applying the fact that W is independent of X given F(X ), we obtain
12 + 22 + 32 = z12 2 + z2I z2 + 2z2cz1

806

A. ABADIE AND G. W. IMBENS

Hence, by the Martingale Central Limit Theorem and the Cramer­Wold device, under PN ,

DN (N ) N (N )

d N

0 0

2 c c I

proving (A.1) and thus Proposition 2.

Q.E.D.

PROOF OF THEOREM 1: Given our preliminary results, Theorem 1 follows

from Andreou and Werker (2012).

Q.E.D.

The proof of Theorem 2 can be found in the Supplemental Material.

REFERENCES
ABADIE, A. (2005): "Semiparametric Difference-in-Differences Estimators," Review of Economic Studies, 72 (1), 1­19. [782]
ABADIE, A., AND G. W. IMBENS (2006): "Large Sample Properties of Matching Estimators for Average Treatment Effects," Econometrica, 74 (1), 235­267. [781,784,785,789,795,796,799] (2008): "On the Failure of the Bootstrap for Matching Estimators," Econometrica, 76 (6), 1537­1557. [782] (2011): "Bias-Corrected Matching Estimators for Average Treatment Effects," Journal of Business and Economic Statistics, 29 (1), 1­11. [784,787] (2012): "A Martingale Representation for Matching Estimators," Journal of the American Statistical Association, 107 (498), 833­843. [788,791,793,801] (2016): "Supplement to `Matching on the Estimated Propensity Score'," Econometrica Supplemental Material, 84, http://dx.doi.org/10.3982/ECTA11293. [786,790,801,803,804]
ANDREOU, E., AND B. J. M. WERKER (2012): "An Alternative Asymptotic Analysis of ResidualBased Statistics," Review of Economics and Statistics, 94 (1), 88­99. [788,791,792,806]
ANGRIST, J. D. (1998): "Estimating the Labor Market Impact of Voluntary Military Service Using Social Security Data on Military Applicants," Econometrica, 66 (2), 249­288. [789]
ANGRIST, J. D., AND G. M. KUERSTEINER (2011): "Causal Effects of Monetary Shocks: Semiparametric Conditional Independence Tests With a Multinomial Propensity Score," Review of Economics and Statistics, 93 (3), 725­747. [782]
BICKEL, P. J., C. A. KLAASSEN, Y. RITOV, AND J. A. WELLNER (1998): Efficient and Adaptive Estimation for Semiparametric Models. New York: Springer. [790]
BILLINGSLEY, P. (1995): Probability and Measure. New York: Wiley. [803] BLINDER, A. S. (1973): "Wage Discrimination: Reduced Form and Structural Estimates," Journal
of Human Resources, 8 (4), 436­455. [800] COCHRAN, W. G. (1968): "The Effectiveness of Adjustment by Subclassification in Removing Bias
in Observational Studies," Biometrics, 24 (2), 295­313. [789] DAWID, A. P. (1979): "Conditional Independence in Statistical Theory," Journal of the Royal Sta-
tistical Society, Series B, 41 (1), 1­31. [783] DEHEJIA, R., AND S. WAHBA (1999): "Causal Effects in Nonexperimental Studies: Reevaluating
the Evaluation of Training Programs," Journal of the American Statistical Association, 94 (448), 1053­1062. [782,787] DINARDO, J., N. M. FORTIN, AND T. LEMIEUX (1996): "Labor Market Institutions and the Distribution of Wages, 1973­1992: A Semiparametric Approach," Econometrica, 64 (5), 1001­1044. [800] GOLDBERGER, A. S. (1991): A Course in Econometrics. Cambridge, MA: Harvard University Press. [792]

MATCHING ON THE ESTIMATED PROPENSITY SCORE

807

HAHN, J. (1998): "On the Role of the Propensity Score in Efficient Semiparametric Estimation of Average Treatment Effects," Econometrica, 66 (2), 315­331. [781,783]
HECKMAN, J., H. ICHIMURA, AND P. TODD (1997): "Matching as an Econometric Evaluation Estimator: Evidence From a Job Training Programme," Review of Economic Studies, 64 (4), 605­654. [782] (1998): "Matching as an Econometric Evaluation Estimator," Review of Economic Studies, 65 (2), 261­294. [781,782]
HIRANO, K., G. W. IMBENS, AND G. RIDDER (2003): "Efficient Estimation of Average Treatment Effects Using the Estimated Propensity Score," Econometrica, 71 (4), 1161­1189. [782]
IMBENS, G. (2004): "Nonparametric Estimation of Average Treatment Effects Under Exogeneity: A Review," Review of Economics and Statistics, 86 (1), 1­29. [781]
IMBENS, G., AND J. WOOLDRIDGE (2009): "Recent Developments in the Econometrics of Program Evaluation," Journal of Economic Literature, 47 (1), 5­86. [781]
KHAN, S., AND E. TAMER (2010): "Irregular Identification, Support Conditions, and Inverse Weight Estimation," Econometrica, 78 (6), 2021­2042. [783]
KIEFER, N. M., AND T. J. VOGELSANG (2005): "A New Asymptotic Theory for HeteroskedasticityAutocorrelation Robust Tests," Econometric Theory, 21, 1130­1164. [784]
LEHMANN, E. L., AND J. P. ROMANO (2005): Testing Statistical Hypothesis. New York: Springer. [790]
LITTLE, R. J., AND D. B. RUBIN (2002): Statistical Analysis With Missing Data (Second Ed.). Hoboken, NJ: Wiley-Interscience. [800]
NEWEY, W. K., AND D. MCFADDEN (1994): "Large Sample Estimation and Hypothesis Testing," in Handbook of Econometrics, Vol. 4, ed. by R. F. Engle and D. McFadden. Amsterdam: Elsevier Science. [782]
OAXACA, R. (1973): "Male­Female Wage Differentials in Urban Labor Markets," International Economic Review, 14 (3), 693­709. [800]
ROSENBAUM, P., AND D. B. RUBIN (1983): "The Central Role of the Propensity Score in Observational Studies for Causal Effects," Biometrika, 70 (1), 41­55. [781,783,784,786]
RUBIN, D. B. (1974): "Estimating Causal Effects of Treatments in Randomized and NonRandomized Studies," Journal of Educational Psychology, 66 (5), 688­701. [783,784]
SMITH, J., AND P. TODD (2005): "Does Matching Overcome LaLonde's Critique of Nonexperimental Estimators?" Journal of Econometrics, 125 (1­2), 305­353. [782]
VAN DER VAART, A. (1998): Asymptotic Statistics. New York: Cambridge University Press. [790, 791]
WOOLDRIDGE, J. M. (2007): "Inverse Probability Weighted Estimation for General Missing Data Problems," Journal of Econometrics, 141 (2), 1281­1301. [782,800]
YATCHEW, A. (1997): "An Elementary Estimator of the Partial Linear Model," Economics Letters, 75, 135­143. [784]

John F. Kennedy School of Government, 79 John F. Kennedy Street, Cambridge, MA 02138, U.S.A. and NBER; alberto_abadie@harvard.edu
and Stanford Graduate School of Business, 655 Knight Way, Stanford, CA 943057298, U.S.A. and NBER; imbens@stanford.edu.
Co-editor Elie Tamer handled this manuscript.
Manuscript received December, 2012; final revision received August, 2015.

